---
title: "Tvyal Newsletter"
author: "Aghasi Tavadyan"
date: "2024-02-09"
# output:
#   pdf_document:
#     # latex_engine: xelatex
#     latex_engine: lualatex
# mainfont: "DejaVu Serif"  
# polyglossia:
#   - Armenian

output: html_document
---

ีีกึีฃีกีถึีถีฅึีธีพ,            
ิฑีฒีกีฝีซ ินีกีพีกีคีตีกีถ         
09.02.2024          
[tvyal.com](https://www.tvyal.com/)      
[tavadyan.com](https://www.tavadyan.com/)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(scales)
library(readxl)
library(rio)

library(RcppRoll)

library(Hmisc)
library(ggridges)
library(toOrdinal)
library(gt)


rm(list = ls()); gc()

theme_tvyal <- function(base_size = 12, base_family = "sans")
{
  colors <- deframe(ggthemes::ggthemes_data[["fivethirtyeight"]])
  (ggthemes::theme_foundation(
    base_size = base_size, base_family = base_family) +
      theme(
        line = element_line(colour = "black"),
        rect = element_rect(fill = "white", linetype = 0, colour = NA),
        text = element_text(colour = colors["Dark Gray"]),
        # axis.title = element_blank(),
        # axis.text = element_text(),
        axis.ticks = element_blank(),
        axis.line = element_blank(),
        legend.background = element_rect(),
        legend.position = "bottom",
        legend.direction = "horizontal",
        legend.box = "vertical",
        panel.grid = element_line(colour = NULL),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_line(colour = colors["Medium Gray"]),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0, size = rel(1.5), face = "bold"),
        plot.margin = unit(c(1, 1, 1, 1), "lines"), strip.background = element_rect()
      )
  )
}

theme_set(theme_tvyal())


new_palette_colors <- c(
  "#003f5c", "#2f4b7c", "#665191", "#a05195",
  "#d45087", "#f95d6a", "#ff7c43", "#ffa600"
)
colfunc <- colorRampPalette(c("#2f4b7c", "#fffcf5", "#f95d6a"))
colfunc2 <- colorRampPalette(new_palette_colors)
colfunc3 <- colorRampPalette(c(new_palette_colors, "#FFD17A", "#FFFCF5"))

update_geom_defaults("rect", list(fill  = new_palette_colors[2], alpha = 0.8))
update_geom_defaults("line", list(color = new_palette_colors[2], alpha = 0.8))
update_geom_defaults("area", list(fill  = new_palette_colors[2], alpha = 0.8))

caption_arm <-  ""
caption_eng <-  ""

doParallel::registerDoParallel(cores = 8)

setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
```

# 1. ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีจ ีกีฒึีกีฟีกึีฅีฌ ีฅีถ 2022 ีฉีพีกีฏีกีถีซีถ
## ิณีถีกีณีธีพ ีณีทีฃึีฟีพีกีฎ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีจีถีคีฐีกีถีธึึ ีฅีฏีกีดีฟีซ ีพีฅึีฌีธึีฎีธึีฉีตีธึีถ

```{r data download, include=FALSE}
# Household database is aggregated from this official source:
# https://www.armstat.am/en/?nid=205

household_income_db <- read_csv("2024_01_07_household_income/household_income_db.csv")


inflation_row <- read_excel("2024_01_07_household_income/cpi_armenia_eng.xls", skip = 3)

inf_cumprod <- 
  inflation_row |> 
  rename(date = 1, cpi_m = 2) |> 
  select(date, cpi_m) |> 
  mutate(
    date = ym(date),
    cpi_m = cpi_m / 100,
    year = year(date)
  ) |> 
  filter(year <= 2022) |>
  select(-year) |> 
  arrange(desc(date)) |> 
  mutate(
    adj_price = cumprod(cpi_m),
    adj_price = lag(adj_price),
    adj_price = ifelse(is.na(adj_price), 1, adj_price)
  )

marz_dict <- 
  tibble(
    marz = 1:12,
    marz_eng = c(
      "Yerevan", "Aragatsotn", "Ararat", "Armavir", "Gegharkunik", "Lori", 
      "Kotayk", "Shirak", "Syunik", "Vayots Dzor", "Tavush", "Armenia"
    ),
     marz_arm = c(
      "ิตึึีกีถ", "ิฑึีกีฃีกีฎีธีฟีถ", "ิฑึีกึีกีฟ", "ิฑึีดีกีพีซึ", "ิณีฅีฒีกึึีธึีถีซึ", "ิผีธีผีซ",
       "ิฟีธีฟีกีตึ", "ีีซึีกีฏ", "ีีตีธึีถีซึ", "ีีกีตีธึ ีฑีธึ", "ีีกีพีธึีท", "ีีกีตีกีฝีฟีกีถ"
    )
  )
```


```{r income_table, include=FALSE}
income_table <- 
  household_income_db |> 
  left_join(inf_cumprod, by = "date") |> 
  mutate(totincome = totincome * adj_price) |> 
  filter(marz == 1) |>
  group_by(year) |> 
  summarise(
    q10 = wtd.quantile(totincome, weight, probs = 0.1),
    median = wtd.quantile(totincome, weight, probs = 0.5),
    mean = sum(totincome*weight)/sum(weight),
    q90 = wtd.quantile(totincome, weight, probs = 0.9),
  ) |> 
  mutate(
    across(-year, ~number(.x/1000, accuracy = 1))
  ) |> 
  gt() |> 
  cols_label(
    year = "ีีกึีซ",
    q10 = "ิฑีดีฅีถีกีกีฒึีกีฟ 10%-ีซ ีพีฅึีซีถ ีทีฅีดีจ (1-ีซีถ ีคีฅึีซีฌ)",
    median = "ีีซีปีซีถ ีจีถีฟีกีถีซึีซ ีฅีฏีกีดีธึีฟ (median)",
    mean = "ีีซีปีซีถ ีฅีฏีกีดีธึีฟ (mean)",
    q90 = "ิฑีดีฅีถีกีฐีกึีธึีฝีฟ 10%-ีซ ีฝีฟีธึีซีถ ีทีฅีดีจ (9-ึีค ีคีฅึีซีฌ)"
  ) |> 
  tab_header(
    title = "ีีกีตีกีฝีฟีกีถีซ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีซ ึีธึีญีธึีฉีตีธึีถีจ",
    subtitle = "ีฐีกีฆีกึ ีคึีกีด, ีฅีฏีกีดีธึีฟีถีฅีจ ีณีทีฃึีฟีพีฅีฌ ีฅีถ 2022 ีฉีพีกีฏีกีถีซ ีพีฅึีปีซ ีฃีถีฅึีธีพ ึ ีฏีทีผีพีฅีฌ"
  ) |>  
  tab_footnote(
    footnote = paste0(caption_eng, "    |    Data Source: armstat.am")
  )
  
```


```{r 2021 2022 change, include=FALSE}

years_select = c(2021, 2022) # provide 2 consecutive years that are in household_income_db

date_legend <- 
  tibble(
    x = 710, y = c(1.5, 2.5), 
    color = c("#2f4b7c", "#f95d6a"), text = rev(years_select)
  )

household_change_in_2_years_plot <- 
  household_income_db %>%
  bind_rows(
    mutate(., marz = 12)
  ) |> 
  left_join(inf_cumprod, by = "date") |> 
  mutate(totincome = totincome * adj_price) |> 
  group_by(year, marz) |>  
  summarise(
    mean = sum(totincome*weight)/sum(weight),
    median = wtd.quantile(totincome, weight, probs = 0.5),
    q10 = wtd.quantile(totincome, weight, probs = 0.1),
    q90 = wtd.quantile(totincome, weight, probs = 0.9),
  ) |>
  pivot_longer(-c(year, marz)) |> 
  left_join(marz_dict, by = "marz") |> 
  filter(
    year %in% years_select,
    name != "mean"
  ) |> 
  ungroup() |> 
  mutate(
    value = value / 1000,
    year = ifelse(year == min(year), "begining", "end")
  ) |> 
  pivot_wider(names_from = year, values_from = value) |> 
  mutate(
    marz_arm = fct_reorder(marz_arm, (begining + end)/2, .fun = mean),
    marz_eng = fct_reorder(marz_eng, (begining + end)/2, .fun = mean),
    color = ifelse(begining > end, "#f95d6a", "#2f4b7c")
  ) |> 
  ggplot() +
  geom_segment(
    aes(x = begining, xend= end,  y= marz_arm, 
        yend=marz_arm, group = name, color = I(color)),
    linewidth = 1.2,
    lineend = 'round', linejoin = 'round',
   arrow = arrow(length = unit(0.1, "inches"))
  ) +
  geom_point(aes(x=begining, y=marz_arm, color=I("#f95d6a")), size = 3) +
  geom_point(aes(x=end, y=marz_arm, color=I("#2f4b7c")), size = 3) +
  geom_point(data = date_legend, aes(x, y, color = I(color)), size = 3) +
  geom_text(data = date_legend, aes(x + 25, y, label = text)) +
  geom_vline(xintercept = c(170, 390)) +  #dividers are changed manually
  annotate(
    geom = "text", x = c(95, 280, 595), y = 13, #dividers are changed manually
    label = c(
      "ิฑีดีฅีถีกีกีฒึีกีฟ 10%-ีซ\nีพีฅึีซีถ ีทีฅีดีจ (1-ีซีถ ีคีฅึีซีฌ)",
      "ีีซีปีซีถ ีจีถีฟีกีถีซึีซ\nีฅีฏีกีดีธึีฟ (median)",
      "ิฑีดีฅีถีกีฐีกึีธึีฝีฟ 10%-ีซ\nีฝีฟีธึีซีถ ีทีฅีดีจ (9-ึีค ีคีฅึีซีฌ)"
    )
  ) +
  scale_x_continuous(breaks = seq(0, 800, 100), labels = number_format()) +
  scale_y_discrete(expand = c(0.05,0,0.2,0)) +
  labs(
    x = NULL,
    y = NULL,
    color = NULL,
    title = "ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีซ ึีธึีธีญีธึีฉีตีธึีถีจ ีจีฝีฟ ีดีกึีฆีฅึีซ",
    subtitle = "2022-ีซีถ ีีกีตีกีฝีฟีกีถีซ ีฅีฏีกีดีธึีฟีถีฅึีจ ีบีกีฏีกีฝีฅีฌ ีฅีถ, ีขีกึีซ ิฟีธีฟีกีตึีซ, ิณีฅีฒีกึึีธึีถีซึีซ ึ ีีกีพีธึีทีซ ีดีกึีฆีซึ,\nีฐีกีฆีกึ ีี ีคึีกีด",
    caption = paste0(caption_arm, "    |    ีฟีพีตีกีฌีถีฅึีซ ีกีฒีขีตีธึึ` armstat.am")
  )
```


```{r income change from 2018 to 2022, include=FALSE}

wealth_change_data <- 
  household_income_db %>%
  bind_rows(
    mutate(., settlement = "Total")
  ) |> 
  left_join(inf_cumprod, by = "date") |> 
  mutate(totincome = totincome * adj_price) |> 
  group_by(year, settlement) |> 
  summarise(
    mean = sum(totincome*weight)/sum(weight),
    median = wtd.quantile(totincome, weight, probs = 0.5),
    q10 = wtd.quantile(totincome, weight, probs = 0.1),
    q90 = wtd.quantile(totincome, weight, probs = 0.9),
  )

household_change_18_22_plot <- 
  wealth_change_data |> 
  pivot_longer(c(mean, median, q10, q90)) |> 
  filter(year %in% 2018:2022) |> 
  mutate(
    settlement = factor(
      settlement,
      levels = c("Total", "Yerevan", "urban", "rural"),
      labels = c("ีีกีตีกีฝีฟีกีถ", "ิตึึีกีถ", "ีกีตีฌ ึีกีฒีกึีถีฅึ", "ีฃีตีธึีฒีฅึ")
    ),
    name = factor(
      name, 
      levels = c("q10", "median", "mean", "q90"),
      labels = c("ิฑีดีฅีถีกีกีฒึีกีฟ 10%-ีซ ีพีฅึีซีถ\nีทีฅีดีจ (1-ีซีถ ีคีฅึีซีฌ)", "ีีซีปีซีถ ีจีถีฟีกีถีซึีซ ีฅีฏีกีดีธึีฟ\n(median)",
                 "ีีซีปีซีถ ีฅีฏีกีดีธึีฟ\n(mean)", "ิฑีดีฅีถีกีฐีกึีธึีฝีฟ 10%-ีซ ีฝีฟีธึีซีถ\nีทีฅีดีจ (9-ึีค ีคีฅึีซีฌ)")
    ),
    text = number(value / 1000, accuracy = 1)
  ) |> 
  ggplot(aes(as.factor(year), value, label = text, fill = as.factor(year))) +
  geom_col() +
  geom_text(aes(y = 50000), color = "white") +
  facet_grid(settlement~name, switch = "both") +
  scale_fill_manual(values = new_palette_colors[6:2]) +
  labs(
    y = NULL,
    x = NULL,
    fill = NULL,
    title = "ีีกีตีกีฝีฟีกีถีซ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีซ ึีธึีธีญีธึีฉีตีธึีถีจ",
    subtitle = "ีีกีฆีกึ ีคึีกีด, ีฅีฏีกีดีธึีฟีถีฅีจ ีณีทีฃึีฟีพีฅีฌ ีฅีถ 2022 ีฉีพีกีฏีกีถีซ ีพีฅึีปีซ ีฃีถีฅึีธีพ ึ ีฏีทีผีพีฅีฌ",
    caption = paste0(caption_arm, "    |    ีฟีพีตีกีฌีถีฅึีซ ีกีฒีขีตีธึึ` armstat.am")
  ) +
  theme(
    axis.text = element_blank(),
    panel.grid.major = element_blank()
  )
```


```{r percentage change, include=FALSE}

household_pct_change_plot <- 
  household_income_db |> 
  select(year, date, weight, marz, totincome) |> 
  left_join(inf_cumprod, join_by(date)) |> 
  mutate(totincome = totincome * adj_price) |>
  mutate(
    income_bin = cut(
      totincome/1000,
      breaks = c(0, 2^(4:11), 1e5),
      include.lowest = TRUE
    )
  ) |> 
  group_by(year) |> 
  # begin weighting data
  count(year, income_bin, wt = weight) |> 
  # end weighting data
  group_by(year) |> 
  extract(income_bin, into = c("lower_cut", "upper_cut"),
          regex = ".(.*),(.*)\\]", remove = FALSE, convert = TRUE) |> 
  mutate(
    pct = n/sum(n),
    label = case_when(
      lower_cut == 0 ~ paste0(upper_cut, " ีฐีกีฆีกึ ีคึีกีดีซึ ีบีกีฏีกีฝ"),
      upper_cut == 1e5 ~ paste0(round(lower_cut/1000), " ีดีฌีถ. ีคึีกีดีซึ ีกีพีฅีฌ"),
      lower_cut == 512 ~ paste0(lower_cut, " ีฐีกีฆีกึ ีคึีกีดีซึ ีดีซีถีนึ ",
                                round(upper_cut/1000), " ีดีฌีถ. ีคึีกีด"),
      lower_cut > 1000 ~ paste0(round(lower_cut/1000), "-ีซึ ีดีซีถีนึ ",
                                round(upper_cut/1000), " ีดีฌีถ. ีคึีกีด"),
      TRUE ~ paste0(lower_cut, "-ีซึ ีดีซีถีนึ ", upper_cut, " ีฐีกีฆีกึ ีคึีกีด")
    )
  ) |> 
  arrange(lower_cut) |> 
  mutate(
    label = fct_inorder(label),
    label = fct_rev(label),
    pct_text = ifelse(pct <= 0.01, NA, percent(pct, accuracy = 0.1))
  ) |> 
  ungroup() |> 
  ggplot(aes(year, pct, fill = label, label = pct_text)) +
  geom_col(alpha = 0.8) +
  geom_text(position = position_stack(vjust = .5)) +
  scale_x_continuous(breaks = seq(2005, 2022, 1)) +
  scale_y_continuous(labels = percent_format()) +
  # scale_fill_brewer(type = "div", palette = 1, direction = -1) +
  scale_fill_manual(values = colfunc(9)) +
  labs(
    x = NULL,
    y = NULL,
    fill = NULL,
    title = "ีึึีกีีถ ีง ีีกีตีกีฝีฟีกีถีซ ีจีถีฟีกีถีซึีถีฅึีซ ีกีดีฝีกีฏีกีถ ีฅีฏีกีดีธึีฟีจ",
    subtitle = "ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีซ ีขีกีทีญีพีกีฎีธึีฉีตีธึีถีจ ีจีฝีฟ ีฟีกึีซีถีฅึีซ\nิตีฏีกีดีธึีฟีถีฅีจ ีณีทีฃึีฟีพีฅีฌ ีฅีถ 2022 ีฉีพีกีฏีกีถีซ ีพีฅึีปีซ ีฃีถีฅึีธีพ ึ ีฏีทีผีพีฅีฌ",
    caption = paste0(caption_arm, "    |    ีฟีพีตีกีฌีถีฅึีซ ีกีฒีขีตีธึึ` armstat.am")
  ) +
  theme(
    panel.grid.major.x = element_blank()
  )

```


```{r percentage change 2, include=FALSE}

household_pct_change_plot_2 <-
  household_income_db |> 
  filter(
    year >= 2005,
    totincome != 0,
    !is.na(totincome)
  ) |> 
  select(year, date, marz, totincome, weight) |> 
  left_join(inf_cumprod, join_by(date)) |> 
  mutate(totincome = totincome * adj_price) |> 
  ggplot(aes(
    x = totincome, y = as.factor(year), 
    fill = 0.5 - abs(0.5 - after_stat(ecdf)),
    # weight = weight
  )) +
  stat_density_ridges(
    quantile_lines = TRUE, scale = 3,
    rel_min_height = 0.01,  quantiles = 4, alpha = 0.5,
    geom = "density_ridges_gradient", calc_ecdf = TRUE
  ) +
  scale_x_log10(breaks = 10^(4:6), labels = number_format(), limits = c(10^3.5, 10^6.5)) +
  # scale_fill_viridis_c(name = "ีีกีพีกีถีกีฏีกีถีธึีฉีตีธึีถ", direction = -1) +
  scale_fill_gradientn(name = "ีีกีพีกีถีกีฏีกีถีธึีฉีตีธึีถ", colors = rev(colfunc(100))) +
  labs(
    x = "ีคึีกีด",
    y = NULL,
    title = "ีึึีกีีถ ีง ีีกีตีกีฝีฟีกีถีซ ีจีถีฟีกีถีซึีถีฅึีซ ีกีดีฝีกีฏีกีถ ีฅีฏีกีดีธึีฟีจ",
    subtitle = "ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีซ ีขีกีทีญีพีกีฎีธึีฉีตีธึีถีจ ีจีฝีฟ ีฟีกึีซีถีฅึีซ\nิตีฏีกีดีธึีฟีถีฅีจ ีณีทีฃึีฟีพีฅีฌ ีฅีถ 2021 ีฉีพีกีฏีกีถีซ ีฃีถีฅึีธีพ",
     caption = paste0(caption_arm, "    |    ีฟีพีตีกีฌีถีฅึีซ ีกีฒีขีตีธึึ` armstat.am")
  ) +
  annotation_logticks(base = 10, sides = "b")
```



2022-ีซีถ ีฃึีกีถึีพีฅีฌ ีง 12.6 ีฟีธีฏีธีฝ ีฟีถีฟีฅีฝีกีฏีกีถ ีกีณ, ีดีฅีฏ ีทีถีนีซีถ ีจีถีฏีถีธีฒ ีีิฑ-ีถ ีกีณีฅีฌ ีง 4 972 ีคีธีฌีกึีซึ ีดีซีถีนึ 7 018 ีคีธีฌีกึ, ีกีตีฝีซีถึีถ 41 ีฟีธีฏีธีฝีธีพ, ีฝีกีฏีกีตีถ ีชีธีฒีธีพึีคีซ ีซึีกีฏีกีฏีกีถ ีฅีฏีกีดีธึีฟีถีฅึีจ ีจีถีฏีฅีฌ ีฅีถึ

2021-ีซีถ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีดีซีปีซีถ ีณีทีฃึีฟีพีกีฎ ีฅีฏีกีดีธึีฟีจ ีฏีกีฆีดีฅีฌ ีงึ 333 ีฐีกีฆีกึ ีคึีกีด, ีซีฝีฏ 2022-ีซีถี 320 ีฐีกีฆีกึ ีคึีกีดึ ิฒีถีกีฏีนีธึีฉีตีกีถ ีกีดีฅีถีกีกีฒึีกีฟ 10% ีทีฅีดีจ ีฝีฟีกีถีธึีด ีงึ ีดีซีถีนึ 101 ีฐีกีฆีกึ ีคึีกีด 2021 ีฉีพีกีฏีกีถีซีถ, ีซีฝีฏ 2022-ีซีถี ีกึีคีฅีถ 88 ีฐีกีฆีกึ ีคึีกีด:

ิฑีผีกีปีซีถ ีฃีฎีกีบีกีฟีฏีฅึีธึีด ีฟีธีฒีฅึีจ ีถีฅึีฏีกีตีกึีถีธึีด ีฅีถ ีดีกึีฆีฅึีจ, ีซีฝีฏ ีฝีตีธึีถีฅึีจ ีฐีกีฝีกึีกีฏีธึีฉีตีกีถ ีญีกีพีฅึีจ (ีกีถีกีบีกีฐีธีพ ีญีกีพ, ีดีซีปีซีถ ีญีกีพ ึ ีฐีกึีธึีฝีฟีถีฅึ)ึ ิตีฉีฅ ีฃีซีฎีจ ีฏีกึีดีซึ ีง, ีกีบีก ีถีกีญีธึีค ีฟีกึีพีก ีฐีกีดีฅีดีกีฟ ีฅีฏีกีดีธึีฟีถีฅึีจ ีบีกีฏีกีฝีฅีฌ ีฅีถ, ีฅีฉีฅ ีฏีกีบีธึีตีฟ ีกีบีกี ีกีณีฅีฌึ

**ิณีฎีกีบีกีฟีฏีฅึ 1.** ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฐีกีดีกีญีกีผีถ ีฅีฏีกีดีธึีฟีถีฅึีซ ึีธึีธีญีธึีฉีตีธึีถีจ ีจีฝีฟ ีดีกึีฆีฅึีซ

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 6}
household_change_in_2_years_plot
```

ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีจ 2022 ีฉีพีกีฏีกีถีซีถ ีบีกีฏีกีฝีฅีฌ ีฅีถ ีขีธีฌีธึ ีดีกึีฆีฅึีธึีด ีขีกึีซ ิฟีธีฟีกีตึีซ, ิณีฅีฒีกึึีธึีถีซึีซ ึ ีีกีพีธึีทีซ ีดีกึีฆีฅึีซึึ

ิตึึีกีถีธึีด ึ ิฑึีกีฃีกีฎีธีฟีถีธึีด 2022 ีฉีพีกีฏีกีถีซีถ ีฐีกึีธึีฝีฟีถีฅึีจ ีกีพีฅีฌีซ ีฅีถ ีฐีกึีฝีฟีกึีฅีฌ, ีซีฝีฏ ีกีฒึีกีฟีถีฅึีจ ีกีพีฅีฌีซ ีฅีถ ีกีฒึีกีฟีกึีถีฅีฌึ

ีีถีกึีกีฎ ีดีกึีฆีฅึีธึีด, ีซีถีนีบีฅีฝ ีถีกึ ีกีดีขีธีฒีป ีีกีตีกีฝีฟีกีถีซ ีฐีกีดีกึ, ีขีธีฌีธึ ีญีกีพีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีจ ีฐีกีดีฅีดีกีฟีกีฎ 2021 ีฉีพีกีฏีกีถีซ ีฐีฅีฟ ีบีกีฏีกีฝีฅีฌ ีฅีถึ

ิดีซีฟีกึีฏีฅีถึ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีซ ึีธึีธีญีธึีฉีตีธึีถีจ 2018 ีฉีพีกีฏีกีถีซึ ีฝีฏีฝีกีฎึ ิปีถีนีบีฅีฝ ีฅึึีธึีด ีง ีฃีถีกีณีธีพ ีณีทีฃึีฟีพีกีฎ ีฅีฏีกีดีธึีฟีถีฅึีจ ีีกีตีกีฝีฟีกีถีซ ีฐีกีดีกึ ีกีดีฅีถีกีขีกึีฑึ ีฏีฅีฟีธึีด ีงีซีถ 2020 ีฉีพีกีฏีกีถีซีถ, ีดีซีปีซีถ ีพีซีณีกีฏีกีฃึีกีฏีกีถ ีจีถีฟีกีถีซึีจ ีฝีฟีกีถีธึีด ีงึ ีกีดีฝีกีฏีกีถ 278 ีฐีกีฆีกึ ีคึีกีด (2022 ีฟีกึีฅีพีฅึีปีซ ีฃีถีฅึีธีพ): ิตึีฏีธึ ีฟีกึีพีก ีจีถีฉีกึึีธึีด ีดีซีปีซีถ ีจีถีฟีกีถีซึีซ ีฅีฏีกีดีธึีฟีจ ีจีถีฏีฅีฌ ีง 15 ีฐีกีฆีกึ ีคึีกีดีธีพี ีดีซีถีนึ 263 ีฐีกีฆีกึ ีคึีกีดึ ิตึึีกีถีธึีด ีดีซีปีซีถ ีจีถีฟีกีถีซึีซ ีฅีฏีกีดีฟีกีขีฅึีธึีฉีตีธึีถีจ ีนีซ ึีธีญีพีฅีฌ ีกีตีฝ 2 ีฟีกึีซีถีฅึีซ ีจีถีฉีกึึีธึีด, ีกีตีถ ีฐีซีดีกีฏีกีถีธึีด ีจีถีฏีฅีฌ ีง ีดีกึีฆีฅึีธึีดึ ีีทีพีกีฎ 2 ีฟีกึีซีถีฅึีซ ีจีถีฉีกึึีธึีด ีฅีฏีกีดีธึีฟีซ ีกีณ ีฅีถ ีฃึีกีถึีฅีฌ ิตึึีกีถีซ ีฐีกึีธึีฝีฟ ีญีกีฒีพีซ ีถีฅึีฏีกีตีกึีธึึีนีถีฅึีจ (9-ึีค ีคีฅึีซีฌ), ีธึีธีถึ ีจีถีฟีกีถีฅีฏีกีถ ีซึีกีฏีกีถ ีฅีฏีกีดีธึีฟีซ ีทีฅีดีจ ีขีกึีฑึีกึีฅีฌ ีง 629 ีฐีกีฆีกึีซึ 2022 ีฉีพีกีฏีกีถีซีถ ีดีซีถีนึ 671 ีฐีกีฆีกึ ีคึีกีดึ

ีีกีปีธึีค ีฃีฎีกีบีกีฟีฏีฅึีจ ีฐีกีดีฅีดีกีฟีธึีด ีง ีฃีถีกีณีธีพ ีณีทีฃึีฟีพีกีฎ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฟีกึีฅีฏีกีถ ีฅีฏีกีดีธึีฟีถีฅึีจ 2005 ีฉีพีกีฏีกีถีซึ ีฝีฏีฝีกีฎึ ิตีฏีกีดีธึีฟีถีฅึีจ ีขีกีชีกีถีพีฅีฌ ีฅีถ ีกีณีธีฒีกีฏีกีถ ีฆีกีดีขีตีธึีฒีถีฅึีซึ 

**ิณีฎีกีบีกีฟีฏีฅึ 3.** ีึึีกีีถ ีง ีีกีตีกีฝีฟีกีถีซ ีจีถีฟีกีถีซึีถีฅึีซ ีกีดีฝีกีฏีกีถ ีฅีฏีกีดีธึีฟีจ

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
household_pct_change_plot
```


ิปีถีนีบีฅีฝ ีฅึึีธึีด ีง ีฃีฎีกีบีกีฟีฏีฅึีซึ ีดีซีถีนึ 128 ีฐีกีฆีกึ ีคึีกีด ีฝีฟีกึีธีฒีถีฅึีจ 3.5 ีฟีธีฏีธีฝีกีตีซีถ ีฏีฅีฟีธีพ ีกีณีฅีฌ ีฅีถ ีฐีกีดีฅีดีกีฟีกีฎ 2021-ีซึ 128-256 ีฐีกีฆีกึ ีคึีกีด ีฝีฟีกึีธีฒีถีฅึีซ ีฉีซีพีจ ีฏึีณีกีฟีพีฅีฌ ีง 1.9 ีฟีธีฏีธีฝีกีตีซีถ ีฏีฅีฟีธีพึ

ีีพีตีกีฌีถีฅึีจ ีกีผีฏีก ีฅีถ 2005 ีฉีพีกีฏีกีถีซึึ ิณีฎีกีบีกีฟีฏีฅึีซึ ีถีกึ ีฅึึีธึีด ีง ีธึ 2005 ีฉีพีกีฏีกีถีซึ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึ ีฃีถีกีณีธีพ ีณีทีฃึีฟีพีกีฎ ีฅีฏีกีดีธึีฟีถีฅึีจ ีฃึีกีถึีฅีฌ ีฅีถ ีฏีกีตีธึีถ ีกีณึ ิธีฝีฟ ีฟีพีตีกีฌีถีฅึีซ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีซึีกีฏีกีถ ีฅีฏีกีดีธึีฟีถีฅึีจ ีกีดีฅีถีกีดีฅีฎ ีกีณีถ ีฅีถ ีกึีฑีกีถีกีฃึีฅีฌ 2006 ึ 2007, ีซีถีนีบีฅีฝ ีถีกึ 2019 ีฉีพีกีฏีกีถีซีถึ

ิฑีถีพีกีถีกีฏีกีถ ีฅีฏีกีดีธึีฟีถีฅึีซ ีกีณ ีฃึีกีถึีพีฅีฌ ีง ีถีกึ 2021 ึ 2022 ีฉีพีกีฏีกีถีถีฅึีซีถ, ีฝีกีฏีกีตีถ ีกีตีค ีฟีกึีซีถีฅึีซีถ ีฃึีกีถึีพีฅีฌ ีง ีฐีกีดีกีบีกีฟีกีฝีญีกีถีกีขีกึ 7.2 ึ 8.6 ีฟีธีฏีธีฝ ีฃีถีกีณ, ีธึีจ ีฆีฃีกีฌีซ ีซีปีฅึึีฅีฌ ีง ีซึีกีฏีกีถ ีฅีฏีกีดีธึีฟีถีฅึีจึ ีีก ีถีทีกีถีกีฏีธึีด ีง ีธึ 2022 ีฉีพีกีฏีกีถีซ ีพีฅึีปีซีถ ีกีทีญีกีฟีกีพีกึีฑีฅึีจ ีคีฅีผ ีนีฅีถ ีฐีกีฝีฅีฌ ีฃีถีกีณีซ ีฟีฅีดีบีซีถ ึ 2022 ีฉีพีกีฏีกีถีซีถ ีฃึีกีถึีพีกีฎ 12.6 ีฟีธีฏีธีฝ ีฟีถีฟีฅีฝีกีฏีกีถ ีกีณีจ ีคีฅีผ ีนีซ ีกีถีคึีกีคีกึีฑีฅีฌ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีซ ีฏีกีด ีกีทีญีกีฟีกีพีกึีฑีฅึีซ ีกีณีซ ีพึีกึ ีีทีฅีด ีธึ 2023 ีฉีพีกีฏีกีถีซ ีพีฅึีปีซีถ ีฃึีกีถึีพีฅีฌ ีง ีฃึีฅีฉีฅ ีฆึีธีตีกีฏีกีถ ีฃีถีกีณึ ิถึีธีตีกีฏีกีถ ีฃีถีกีณีซ ีฟีฅีฝีกีฏีฅีฟีจ ีถีฅึีฏีกีตีกึีพีกีฎ ีง [ีฟีฅีฝีกีถีตีธึีฉีธึีด](https://youtu.be/Va5q9efWaI4)ึ

ิตึึีธึีค ีฃีฎีกีบีกีฟีฏีฅึีธึีด ีถีฅึีฏีกีตีกึีพีกีฎ ีดีซีฟึีจ ีกีตีฌีจีถีฟึีกีถึีกีตีซีถ ีฏีฅึีบีธีพ ีกึีฟีกึีธีฌีธึีด ีง ีถีกึ ีฐีกีปีธึีค ีฃีฎีกีบีกีฟีฏีฅึีจึ

**ิณีฎีกีบีกีฟีฏีฅึ 4.** ีึึีกีีถ ีง ีีกีตีกีฝีฟีกีถีซ ีจีถีฟีกีถีซึีถีฅึีซ ีกีดีฝีกีฏีกีถ ีฅีฏีกีดีธึีฟีจ, ีกีตีฌีจีถีฟึีกีถึีกีตีซีถ ีฐีกีตีกึึ

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 12, fig.height = 8}
household_pct_change_plot_2
```

ิฑีตีฒีธึีฝีกีฏีซ ีฟีฅีฝึีธีพ ีถีฅึีฏีกีตีกึีถีฅีถึ ีถีกึ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีซ ึีธึีธีญีธึีฉีตีธึีถีจ ีฟีกึีซีถีฅึีซ ีจีถีฉีกึึีธึีดึ

```{r, echo=FALSE, fig.width = 6}
income_table
```



ีีพีตีกีฌีถีฅึีจ ีพีฅึึีพีกีฎ ีฅีถ ีบีกีทีฟีธีถีกีฏีกีถ ีกีฒีขีตีธึึีถีฅึีซึ, ีดีกีฝีถีกีพีธึีกีบีฅีฝี [ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฏีฅีถีฝีกีดีกีฏีกึีคีกีฏีซ (ีฏีฅีถีฝีกีบีกีตีดีกีถีถีฅึีซ) ีกีดีขีธีฒีปีกึีพีกีฎ ีฐีฅีฟีกีฆีธีฟีธึีฉีตีกีถ ีกีถีพีกีถีกีฆีฅึีฎีพีกีฎ ีดีซีฏึีธีฟีพีตีกีฌีถีฅึีซ ีขีกีฆีก (ีจีฝีฟ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ)](https://www.armstat.am/en/?nid=205) ึ [ีีกีตีกีฝีฟีกีถีซ ีฝีบีกีผีธีฒีกีฏีกีถ ีฃีถีฅึีซ ีกีดีฝีกีฏีกีถ ีซีถีคีฅึีฝีจ](https://www.cba.am/stat/stat_data_arm/6_CPI_arm.xls): ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฏีฅีถีฝีกีดีกีฏีกึีคีกีฏีซ ึีธึึีกีถีซีทีถีฅึีจ ีณีทีฃึีฟีพีฅีฌ ีฅีถ ีกีดีฝีกีฏีกีถ ีฏีธึีดีธึีฌีกีฟีซีพ ีฃีถีกีณีธีพ, ีกีตีฝีซีถึีถ ีตีธึึีกึีกีถีนีตีธึึ ึีธึึีกีถีซีท ีถีฅึีฏีกีตีกึีถีธึีด ีง 2022 ีฉีพีกีฏีกีถีซ ีพีฅึีปีซ ีฃีถีธีฒีธึีถีกีฏีธึีฉีตีธึีถีจึ ีีธึึีกีถีซีทีถีฅึีจ ีถีกึ ีฏีทีผีพีฅีฌ ีฅีถึ ีีกีทีพีกึีฏีถีฅึีจ ีฏีกึีฅีฌีซ ีง ีฝีฟีธึีฃีฅีฌ ีกีตึีฅีฌีฅีฌีธีพ [github-ีซ](https://github.com/tavad/tvyal_newsletter) ีดีฅึ ีงีปีจ, ีธึีฟีฅีฒ ีฟึีพีกีฎ ีฅีถ ีฟีพีตีกีฌีถีฅึีจ, ีฐีกีทีพีกึีฏีถีฅึีซ ึ ีฃีฎีกีบีกีฟีฏีฅึีถีฅึีซ ีฏีธีคีจึ 


\newpage
















# 2. ิฑีดีธึึ ีจีถีฟีกีถีซึ. ีฐีกึีธึีฝีฟ ีจีถีฟีกีถีซึ

## ีีกีตีกีฝีฟีกีถีซ ีจีถีฟีกีถีซึีถีฅึีซ ีธึีฝีธึีดีถีกีฝีซึีธึีฉีตีธึีถ

```{r data download 2, include=FALSE}
# Household database is aggregated from this official source:
# https://www.armstat.am/en/?nid=205

household_22 <- read_csv("2024_01_26_households_structure/household_2022.csv")

decile_year = 2022
```




```{r deciles and age plot, include=FALSE}

decile_description <-
  household_22 |> 
  reframe(deciles = quantile(totincome, probs = seq(0.1, 0.9, 0.1))) %>%
  bind_rows(tibble(deciles = NA), .) |>
  mutate(
    deciles2 = lead(deciles),
    x = row_number(),
    description_arm = case_when(
      x == 1 ~ paste0("1-ีซีถ ีคีฅึีซีฌ` ", round(deciles2/1000), " ีฐีกีฆีกึ ีคึีกีดีซึ ีบีกีฏีกีฝ"),
      x == 10 ~ paste0("10-ึีค ีคีฅึีซีฌ` ", round(deciles/1000), " ีฐีกีฆีกึ ีคึีกีดีซึ ีกีพีฅีฌ"),
      TRUE ~ paste0(x, "-ึีค ีคีฅึีซีฌ` ", round(deciles/1000), "-ีซึ ีดีซีถีนึ ",
                    round(deciles2/1000)," ีฐีกีฆีกึ ีคึีกีด"),
    ),
    description_eng = case_when(
      x == 1 ~ paste0("1st decile - less than ", round(deciles2/1000), " thousand drams"),
      x == 10 ~ paste0("10th decile - more than ", round(deciles/1000), " thousand drams"),
      TRUE ~ paste0(toOrdinal(x), " decile - from ", round(deciles/1000), " to ",
                    round(deciles2/1000)," thousand drams"),
    ),
    description_arm = fct_inorder(description_arm),
    description_eng = fct_inorder(description_eng),
    y = 0
  ) |>
  select(description_arm, description_eng, x, y)


deciles_and_age_plot <-
  household_22 |>
  rename(marz = hh_02) |> 
  select(marz, members, totincome, contains("_sum")) |>
  select(-hheld_over63_sum) |>
  mutate(
    hhch_18_62_sum = members - rowSums(across(matches("hh.*_sum")), na.rm = TRUE),
    income_bin = ntile(totincome, 10),
    # income_bin = cut(
    #   totincome/1000,
    #   breaks = c(0, 2^(6:10), 1e5),
    #   include.lowest = TRUE,
    #   labels = c("[0, 64]", "(64, 128]", "(128, 256]",
    #              "(256, 512]", "(512, 1024]", "(1024 & more)")
    # )
  ) |>
  group_by(
    # year,
    # marz,
    income_bin
  ) |>
  summarise(across(contains("_sum"), ~sum(.x, na.rm = TRUE)), .groups = "drop") |>
  pivot_longer(contains("_sum"), names_to = "age_group", values_to = "sum_head_count") |>
  group_by(
    # year,
    # marz,
    income_bin
  ) |>
  mutate(
    age_group = str_remove(age_group, "hhch_|hheld_"),
    age_group = str_remove(age_group, "_sum"),
    age_group = str_replace(age_group, "_", "-"),
    age_group = fct_relevel(age_group, "0-3", "4-5", "6-11", "12-17", "18-62"),
    age_group = fct_rev(age_group),
    pct_head_count = sum_head_count / sum(sum_head_count)
  ) |>
  ungroup() |>
  ggplot() +
  geom_col(aes(income_bin, pct_head_count, fill = age_group)) +
  geom_point(data = decile_description, aes(x, y, color = description_eng)) + # delete cuts
  scale_x_continuous(breaks = 1:10) +   # delete when using cuts
  scale_color_manual(values = rep("#FFFFFF00", 10)) + # delete when using cuts
  scale_y_continuous(labels = percent_format()) +
  scale_fill_manual(values = rev(colfunc(9))) +
  guides(color=guide_legend(nrow = 4,byrow = TRUE)) +
  # facet_wrap(~marz) +
  labs(
    x = "Decil Groups",
    y = NULL,
    fill = "Age Group",
    color = NULL,
    title = "Armenian Household Income by Decil Groups and Age",
    subtitle = "Proportion, data for 2022",
    caption = paste0(caption_eng, "    |    Data Source: armstat.am")
  ) +
  theme(panel.grid.major.x = element_blank())

```




```{r household income by types, include=FALSE}

household_22_income_cuts <-
  household_22 |>
  reframe(
    totincome = wtd.quantile(totincome, weight, probs = seq(0, 1, 0.1))
  ) |>
  pull(totincome)

income_type_dict <-
  tibble(
    name = c(
      "y1_3amd.1.00", "y1_3amd.2.00", "y1_3amd.4.00", "y1_3amd.6.00",
      "y1_3amd.8.00", "y1_3amd.9.00", "y1_3amd.10.00", "y1_3amd.12.00",
      "y1_3amd.13.00", "y1_3amd.14.00", "y1_3amd.15.00", "y1_3amd.17.00",
      "y1_3amd.18.00", "y1_3amd.19.00", "y1_3amd.23.00", "y1_3amd.26.00", "y1_3amd.28.00"
    ),
    name_desc = c(
      "Salary",
      "Self employment",
      "Pension",
      "Family benefit",
      "One-off benefit for child birth",
      "Benefit given for care of a child under 2 years old",
      "Other benefit for the child",
      "Other benefits",
      "Stipendium",
      "Sale of real estate (flat, cottage, land)",
      "Sale of the valuables (car, jewelry, furniture)",
      "Property (rent, interests, dividend)",
      "Money received from relatives, living in Armenia",
      "Money received from relatives, living out of Armenia",
      "Sale of securities",
      "Pension from other country",
      "Other income"
    ),
    name_desc_arm = c(
      "ีกีทีญีกีฟีกีพีกึีฑีซึ",
       "ีซีถึีถีกีฆีขีกีฒีพีกีฎีธึีฉีตีธึีถีซึ",
       "ีฏีฅีถีฝีกีฉีธีทีกีฏีซึ",
       "ีจีถีฟีกีถีฅีฏีกีถ ีถีบีกีฝีฟีซึ",
       "ีฎีถีถีคีตีกีถ ีดีซีกีถีพีกีฃ ีถีบีกีฝีฟีซึ ีฅีฏีกีดีธึีฟ",
       "ีดีซีถีนึ 2 ีฟีกึีฅีฏีกีถ ีฅึีฅีญีกีตีซ ีญีถีกีดึีซ ีฐีกีดีกึ ีฟึีพีธีฒ ีถีบีกีฝีฟีซึ",
       "ีฅึีฅีญีกีตีซ ีฐีกีดีกึ ีกีตีฌ ีถีบีกีฝีฟีซึ",
       "ีกีตีฌ ีถีบีกีฝีฟีถีฅึีซึ",
       "ีฏึีฉีกีฉีธีทีกีฏีซึ",
       "ีกีถีทีกึีช ีฃีธึีตึีซ ีพีกีณีกีผึีซึ",
       "ีฉีกีถีฏีกึีชีฅึ ีซึีฅึีซ ีพีกีณีกีผึีซึ",
       "ีพีกึีฑีกีพีณีกึ, ีฟีธีฏีธีฝีถีฅึ, ีทีกีฐีกีขีกีชีซีถีถีฅึ",
       "ีีกีตีกีฝีฟีกีถีธึีด ีขีถีกีฏีพีธีฒ ีฐีกึีกีฆีกีฟีถีฅึีซึ ีฝีฟีกึีพีกีฎ ีฃีธึีดีกึีถีฅึ",
       "ีีกีตีกีฝีฟีกีถีซึ ีคีธึึีฝ ีกีบึีธีฒ ีฐีกึีกีฆีกีฟีถีฅึีซึ ีฝีฟีกึีพีกีฎ ีฃีธึีดีกึีถีฅึ",
       "ีกึีชีฅีฉีฒีฉีฅึีซ ีพีกีณีกีผึีซึ",
       "ีกีตีฌ ีฅึีฏึีซ ีฏีฅีถีฝีกีฉีธีทีกีฏีซึ",
       "ีกีตีฌ ีฅีฏีกีดีธึีฟีถีฅึ"
    )
  )

income_data <-
  household_22 |>
  mutate(
     deciles = cut(
      totincome,
      breaks = household_22_income_cuts,
      labels = 1:10,
      include.lowest = TRUE
    )
  ) |>
  select(deciles, weight, contains("y1_3amd")) |>
  mutate(
    across(-c(deciles, weight), ~ifelse(is.na(.x), 0, .x))
  ) |>
  group_by(deciles) |>
  reframe(
    across(-weight, ~sum(.x * weight) / sum(weight))
  ) |>
  ungroup() |>
  pivot_longer(-deciles) |>
  mutate(
    name = fct_lump_n(name, n = 6, w = value,  other_level = "y1_3amd.28.00")
  ) |>
  group_by(deciles, name) |>
  summarise(
    value = sum(value)
  ) |>
  ungroup() |>
  left_join(income_type_dict, join_by(name)) |>
  group_by(deciles) |>
  mutate(
    pct = value / sum(value),
    pct_text = ifelse(pct < 0.01, NA, percent(pct, accuracy = 0.1)),
    value_text = ifelse(value < 7e3, NA, number(value / 1000, accuracy = 1)),
    name_number = str_replace(name, "y1_3amd.(\\d+).00", "\\1"),
    name_number = as.integer(name_number)
  ) |>
  ungroup() |>
  arrange(name_number) |>
  mutate(
    name_desc = fct_inorder(name_desc),
    name_desc_arm = fct_inorder(name_desc_arm)
  )

income_deciles_drams <-
  income_data |>
  ggplot(aes(deciles, value / 1000, fill = name_desc, label = value_text)) +
  geom_col() +
  geom_text(position = position_stack(vjust = .5)) +
  scale_fill_manual(values = colfunc3(7)) +
  scale_y_continuous(breaks = seq(0, 1000, 100), labels = number_format()) +
  guides(fill=guide_legend(nrow=4,byrow=TRUE)) +
  theme( panel.grid.major = element_blank()) +
  labs(
    x = NULL,
    y = NULL,
    fill = NULL,
    title = "Sources of Income in Armenian Households",
    subtitle = "Thousand drams, by decil groups, 2022",
    caption = paste0(caption_eng, "    |    Data Source: armstat.am")
  )

income_deciles_pct <-
  income_data |>
  ggplot(aes(deciles, pct, fill = name_desc, label = pct_text)) +
  geom_col() +
  geom_text(position = position_stack(vjust = .5)) +
    scale_fill_manual(values = colfunc3(7)) +
  scale_y_continuous(breaks = seq(0, 1, 0.25), labels = percent_format()) +
  guides(fill=guide_legend(nrow=4,byrow=TRUE)) +
  theme( panel.grid.major = element_blank()) +
   labs(
    x = NULL,
    y = NULL,
    fill = NULL,
    title = "Sources of Income in Armenian Households",
    subtitle = "Proportion, by decil groups, 2022",
    caption = paste0(caption_eng, "    |    Data Source: armstat.am")
  )








```


```{r, include=FALSE}

household_table <- 
  household_22 |> 
  mutate(
    deciles = cut(
      totincome,
      breaks = household_22_income_cuts,
      labels = 1:10,
      include.lowest = TRUE
    ),
    across(matches("hh.*_sum"), ~ifelse(is.na(.x), 0, .x))
  ) |> 
  rename(seniors = hheld_over63_sum) |> 
  mutate(
    hhch_18_62_sum = members - rowSums(across(matches("hh.*_sum")), na.rm = TRUE),
    children = members -hhch_18_62_sum -seniors,
    general_educ = ifelse(headeduc >= 4, 1, 0),
    married = ifelse(headmerstatus == 1, 1, 0)
  ) |> 
  group_by(deciles) |> 
  summarise(
    totincome = wtd.quantile(totincome, weight, probs = 0.5),
    work_age_pct = sum(hhch_18_62_sum, na.rm = TRUE) / sum(members),
    seniors_pct = sum(seniors, na.rm = TRUE) / sum(members),
    children_pct = sum(children, na.rm = TRUE) / sum(members),
    members = mean(members),
    work_age = mean(hhch_18_62_sum, na.rm = TRUE),
    children = mean(children, na.rm = TRUE),
    headage = mean(headage),
    head_woman = mean(headsex) - 1,
    general_educ_pct = mean(general_educ, na.rm = TRUE),
    married = mean(married, na.rm = TRUE)
  ) |> 
  
  gt() |> 
  data_color(
    columns = -c(deciles, seniors_pct, headage, head_woman),
    colors = scales::col_numeric(
      palette = c("#f95d6a", "#fffcf5", "#2f4b7c"),
      domain = NULL
    )
  ) |> 
    data_color(
    columns = c(seniors_pct, headage, head_woman),
    colors = scales::col_numeric(
      palette = c("#2f4b7c", "#fffcf5", "#f95d6a"),
      domain = NULL
    )
  ) |> 
  fmt_number(
    columns = c("members", "work_age", "children"),
    decimals = 2, 
    use_seps = TRUE,
  ) |> 
  fmt_number(
    columns = c("totincome"),
    decimals = 1, 
    scale_by = 0.001,
    use_seps = TRUE,
  ) |> 
   fmt_number(
    columns = c("headage"),
    decimals = 0, 
    use_seps = TRUE,
    # suffixing = "k"  # You can adjust the suffix as needed
  ) |> 
  fmt_number(
    columns = c("work_age_pct", "seniors_pct", "children_pct",
                "head_woman", "general_educ_pct", "married"),
    scale_by = 100,
    decimals = 1,
    pattern = "{x}%"
  ) |> 
  cols_label(
    deciles = "Household Decile",
    totincome = "Average Monthly Income (in thousand AMD)",
    work_age_pct ~ "Working-Age Population (%)",
    seniors_pct = "Senior Population (over 63, %)",
    children_pct = "Child Population (0-17, %)",
    members = "Household Size",
    work_age = "Working-Age",
    children = "Children",
    headage = "Average Age of HH",
    head_woman = "Proportion of Female in HH (%)",
    general_educ_pct = "HH with Basic Education (%)",
    married = "Married HH (%)"
  ) |> 
  tab_spanner(
    label = "Demographic Information",
    columns = c(work_age_pct, seniors_pct, children_pct)
  ) |>
  tab_spanner(
    label = "Household Composition (Average)",
    columns = c(members, work_age, children)
  ) |>
  tab_spanner(
    label = "Head of Household (HH) Details",
    columns = c(headage, head_woman, general_educ_pct, married)
  ) |> 
  tab_header(
    title = "Armenia's Household Demographics",
    subtitle = "Summary of demographic and income information in 2022"
  ) |> 
  tab_footnote(
    footnote = paste0(caption_eng, "    |    Data Source: armstat.am")
  )

```





>
> ีีน ีฌีซีกึีชีฅึ ีจีถีฟีกีถีซึ ีง ีฐีกีดีกึีพีธึีด ีดีฅีฏ ีฎีถีธีฒีซึ ึ ีฅึีฅีญีกีตีซึ ีขีกีฒีฏีกึีกีฎ ีจีถีฟีกีถีซึีจ:
> 
> ีีน ีฌีซีกึีชีฅึ ีจีถีฟีกีถีซึีถีฅึีจ ีขีถีธึีฉีกีฃึีพีธึีด ีฅีถ ีฐีฅีฟึีตีกีฌ ีฐีกีฟีฏีกีถีซีทีถีฅึีธีพี
> 
> * ีธึีขีกึีกีฎ,
> * ีฎีถีธีฒีกีฆีธึึีฏ,
> * ีกีดีธึีฝีถีกีฌีธึีฎีพีกีฎึ
>

ิดีซีฟีกึีฏีฅีถึ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีจ ีจีฝีฟ ีคีฅึีซีฌีกีตีซีถ ีญีดีขีกึีซ ึ ีกีตีค ีญีดีขีฅึีธึีด ีฝีฅีผีกีฟีกึีซึีกีตีซีถ ีฏีกีฆีดีซึ


123 ีฐีกีฆีกึ ีคึีกีดีจ ีนีฃีฅึีกีฆีกีถึีธีฒ ีกีดีฝีกีฏีกีถ ีฅีฏีกีดีธึีฟ ีธึีถีฅึีธีฒ ีจีถีฟีกีถีซึีถีฅึีจ ีฃีฟีถีพีธึีด ีฅีถ 1-2 ีคีฅึีซีฌีกีตีซีถ ีญีดีขีฅึีธึีดึ ิฑีตีฝ ีญีดีขีซีถ ีขีถีธึีธีท ีง ีฟีกึีฅึีถีฅึีซ ีดีฅีฎ ีดีกีฝีถีกีขีกีชีซีถีจ, ีธึีธีถึ ีจีถีฟีกีถีซึีถีฅึีซ ีกีพีฅีฌีซ ึีกีถ 35 ีฟีธีฏีธีฝีจ ีขีกีฒีฏีกึีกีฎ ีง 63 ึ ีขีกึีฑึ ีฟีกึีซึีซ ีฉีธีทีกีฏีกีผีธึีถีฅึีซึ: ิฑีตีฝ ีญีดีขีซ ีจีถีฟีกีถีซึีถีฅึีซ ีดีซีปีซีถ ีดีฅีฎีธึีฉีตีธึีถีจ 2 ีดีกึีค ีงึ ิฑีตีฝ ีจีถีฟีกีถีซึีถีฅึีจ ีฐีซีดีถีกีฏีกีถีธึีด ีฌีซีกึีชีฅึ ีนีฅีถ, ีกีตีฝ ีญีดีขีธึีด ีดีซีกีตีถ ีดีฅีฏ ีฅึึีธึีคีถ ีง ีธึ ีกีดีธึีฝีซีถ ีธึีถีซ: ิตึีฅีญีกีถีฅึีซ ีกีดีฅีถีกึีกีฎึ ีดีกีฝีถีกีขีกีชีซีถีจ ีถีฏีกีฟีพีธึีด ีง ีกีตีฝ ีญีดีขีธึีด, ีกีทีญีกีฟีธึีถีกีฏ ีฟีกึีซึีซ ีกีถีฑีกีถึ ีกีพีฅีฌีซ ึีกีฎึ ีฏีทีผีซ ีฐีฅีฟ ีดีฅีฏีฟีฅีฒ:

**ิณีฎีกีบีกีฟีฏีฅึ 1.** ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ึ ีฟีกึีซึีกีตีซีถ ีญีดีขีกึีซ ีขีกีทีญีพีกีฎีธึีฉีตีธึีถีจ

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
deciles_and_age_plot
```


```
ิดีฅึีซีฌีกีตีซีถ ีญีธึีดีขีฅึีจ ีฟีพีตีกีฌีถีฅึีซ ีขีกีฆีกีถ ีขีกีชีกีถีธึีด ีฅีถ ีฟีกีฝีจ ีฐีกีพีกีฝีกึ ีดีกีฝีฅึีซ,
ีธึีธีถึีซึ ีตีธึึีกึีกีถีนีตีธึึีจ ีถีฅึีฏีกีตีกึีถีธึีด ีง ีจีถีคีฐีกีถีธึึ ีคีซีฟีกึีฏีธึีดีถีฅึีซ 10%-ีจี
ีฐีกีพีกีฝีกึ ีฐีกีดีกีดีกีฝีถีธึีฉีตีกีดีข: ิฑีผีกีปีซีถ ีคีฅึีซีฌีจ ีถีฅึีฏีกีตีกึีถีธึีด ีง ีฟีพีตีกีฌีถีฅึีซ 
ีกีผีกีปีซีถ 10%-ีจ, ีฅึีฏึีธึีคีจ ีถีฅึีฏีกีตีกึีถีธึีด ีง ีฅึีฏึีธึีค 10%-ีจ ึ ีกีตีฌีถ, 10-ึีค ีคีฅึีซีฌีจ, 
ีถีฅึีฏีกีตีกึีถีธึีด ีง ีฟีพีตีกีฌีถีฅึีซ ีกีดีฅีถีกีขีกึีฑึ 10%-ีจ:
```


ิปีถีนีบีฅีฝ ีฅึึีธึีด ีง ีฃีฎีกีบีกีฟีฏีฅึีธึีด ีซีถีนึีกีถ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีจ ีกีพีฅีฌีซ ึีซีน ีง ีฝีฟีกีถีธึีด ีฅีฏีกีดีธึีฟ, ีกีตีถึีกีถ ีกีพีฅีฌีซ ีดีฅีฎ ีง ีฐีกีพีกีถีกีฏีกีถีธึีฉีตีธึีถีจ ีธึ ีกีตีค ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีธึีด ีฟีกึีฅึีถีฅึีซ ึีกีถีกีฏีธึีฉีตีธึีถีจ ีกีพีฅีฌีซ ีดีฅีฎ ีฏีฌีซีถีซึ ิฑีตีฝีบีฅีฝ 123 ีฐีกีฆีกึ ีคึีกีดีซึ ึีกีฎึ ีฅีฏีกีดีธึีฟ ีฝีฟีกึีธีฒ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีธึีด 1/3-ีจ 63 ึ ีกีพีฅีฌ ีฟีกึีซึ ีธึีถีฅึีธีฒ ึีกีฒีกึีกึีซีถีฅึ ีฅีถึ ิฑีตีฝีบีฅีฝ ีกีตีฝ ีญีดีขีซ ีพึีก ีกีพีฅีฌีซ ีทีกีฟ ีฅีถ ีจีถีฏีถีธึีด ีกีผีธีฒีปีกีบีกีฐีกีฏีกีถ ีฎีกีญีฝีฅึีจ:

ีึึีกีถ ีดีฅีฎ ีง ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีกีถ ีฃีฌีญีซ ีฟีกึีซึีจ ึ ีธึึีกีถ ีดีฅีฎ ีง ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีกีถ ีฃีฌีญีซ ีฏีซีถ ีฌีซีถีฅีฌีธึ ีฐีกีพีกีถีกีฏีกีถีธึีฉีตีธึีถีจ, ีกีตีถึีกีถ ีดีฅีฎ ีง ีจีถีฟีกีถีซึีซ ีกีถีกีบีกีฐีธีพ ีญีกีพีซ ีดีฅีป ีฐีกีตีฟีถีพีฅีฌีธึ ีฐีกีพีกีถีกีฏีกีถีธึีฉีตีธึีถีจ: ิฑีถีกีบีกีฐีธีพ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีจ ีฐีซีดีถีกีฏีกีถีธึีด ีขีกีฒีฏีกึีกีฎ ีฅีถ ีฟีกึีฅึ ีฏีกีถีกีถึีซึ, ีธีพึีฅึ ีนีธึีถีฅีถ ีฐีกึีกีฆีกีฟีถีฅึ, ีธึีธีถึ ีดีธีฟ 40 ีฟีธีฏีธีฝีถ ีธึีถีซ ีฐีซีดีถีกีฏีกีถ ีฏึีฉีธึีฉีตีธึีถ:

ีีกึีธึีฝีฟ ีญีกีพีถ ีกีผีกีถีฑีถีกีถีธึีด ีง ีกีพีฅีฌีซ ีดีฅีฎ ีจีถีฟีกีถีซึีถีฅึีธีพ, ีซีถีนีซ ีดีกีฝีซีถ ีง ีพีฏีกีตีธึีด 10-ึีค ีคีฅึีซีฌีกีตีซีถ ีญีดีขีธึีด ีดีซีปีซีถีจ 5 ีฐีธีฃีกีถีธึ ีจีถีฟีกีถีซึีถีฅึีซ ีนีกึีจึ ิฑีบีกีฐีธีพีพีกีฎ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีถ ีธึีถีฅีถ ีถีกึ ีกีทีญีกีฟีธีฒีถีฅึีซ ีดีฅีฎ ีฉีพีธีพ ีกีถีคีกีดีถีฅึ, ีธึีธีถึีซึ ีฅึีฅึีซึ ีกีพีฅีฌีซ ีกีถีคีกีดีถีฅึ ีฃีฟีถีพีธึีด ีฅีถ ีกีทีญีกีฟีกีถึีกีตีซีถ ีฟีกึีซึีธึีด: ิฑีพีฅีฌีซีถี ีกีบีกีฐีธีพ ีจีถีฟีกีถีซึีถีฅึีซ ีฃีฌีธึีญีถีฅึีซ ีกีพีฅีฌีซ ึีกีถ 77 ีฟีธีฏีธีฝีถ ีธึีถีซ ีกีดีธึีฝีซีถึ ิฑีตีฝีบีซีฝีธีพ, ีกีดีขีธีฒีปีกีฏีกีถ ีจีถีฟีกีถีซึีซ ีกีผีฏีกีตีธึีฉีตีธึีถีจ ีฐีซีดีถีกีฏีกีถีธึีด ีขีถีธึีฉีกีฃึีธึีด ีง ีกีบีกีฐีธีพีพีกีฎ ีจีถีฟีกีถีซึ: ิฟึีฉีธึีฉีตีกีถ ีดีกีฏีกึีคีกีฏีถ ีกีดีฅีถีกีขีกึีฑึีถ ีง 10-ึีค ีคีฅึีซีฌีธึีด, ีธึีซ 56,3 ีฟีธีฏีธีฝีถ ีธึีถีซ ีฐีซีดีถีกีฏีกีถ ีฏึีฉีธึีฉีตีธึีถ:

ีีซีปีซีถ ีญีกีพีจ ีฐีกีฝีกึีกีฏีธึีฉีตีกีถ ีฐีซีดึีถ ีงึ ิฑีตีฝ ีญีกีพีถ ีธึีถีซ ีกีดีฅีถีกีทีกีฟ ีฅึีฅีญีกีถีฅึีซ ีฉีซีพีจึ ิฑีตีฝ ีจีถีฟีกีถีซึีถีฅึีซ ีกีถีคีกีดีถีฅึีซ ีดีธีฟีกีพีธึีกีบีฅีฝ 25 ีฟีธีฏีธีฝีจ ีฅึีฅีญีกีถีฅึ ีฅีถี ีซ ีฟีกึีขีฅึีธึีฉีตีธึีถ ีฐีกึีธึีฝีฟ ีญีกีพีซ, ีธึีจ ีฐีกีดีฅีดีกีฟีกีขีกึ ีกีพีฅีฌีซ ึีซีน ีฅึีฅีญีกีถีฅึ ีธึีถีซึ ิฑีดีฅีถีกีกีบีกีฐีธีพ 10-ึีค ีคีฅึีซีฌีกีตีซีถ ีญีดีขีธึีด ีฅึีฅีญีกีถีฅึีซ ีฟีธีฏีธีฝีจ ีฏีกีฆีดีธึีด ีง 21 ีฟีธีฏีธีฝึ

ิฑีดีขีธีฒีปีกีฏีกีถ ีจีถีฟีกีถีซึีซ ีกีผีฏีกีตีธึีฉีตีธึีถีจ ีงีกีฏีกีถีธึีฅีถ ีกีฆีคีธึีด ีง ีกีบีกีฐีธีพ ึ ีดีซีปีซีถ ีญีกีพีซ ีฑึีกีพีธึีดีกีถ ีพึีก, ีดีซีถีนีคีฅีผ ึีกีฎึ ีญีกีพีซีถ ีกีผีกีพีฅีฌีกีบีฅีฝ ีขีถีธึีธีท ีง ีดีซีกีตีถีธึีฉีตีธึีถีจึ


**ิฑีฒีตีธึีฝีกีฏ 1.** ีี ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีชีธีฒีธีพึีคีกีฃึีกีฏีกีถ ีพีฅึีฌีธึีฎีธึีฉีตีธึีถ

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
household_table
```


>
>ีีทีฅีถึ ีธึ ีกีตีฝ ีพีฅึีฌีธึีฎีธึีฉีตีธึีถีจ ีฟีถีฟีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีพีฅึีฌีธึีฎีธึีฉีตีกีถ 2-ึีค ีดีกีฝีซีถ ีงึ
>
>ิฑีผีกีปีซีถ ีพีฅึีฌีธึีฎีธึีฉีตีธึีถีจ ีฏีกึีคีกึีฅึ ีกีตีฝีฟีฅีฒโค
>
>[๐๐ฐ ๐ ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีจ ีกีฒึีกีฟีกึีฅีฌ ีฅีถ](https://www.tvyal.com/newsletter/2024/2024_01_07):
>

ิปีถีนีบีฅีฝ ีฅึึีธึีด ีง ีดีซีถีนึ 161 ีฐีกีฆีกึ ีคึีกีด ีจีถีคีฐีกีถีธึึ ีฅีฏีกีดีธึีฟ ีฝีฟีกึีธีฒ ีกีผีกีปีซีถ, ีฅึีฏึีธึีค ึ ีฅึึีธึีค ีคีฅึีซีฌีกีตีซีถ ีญีดีขีฅึีซ ีฐีซีดีถีกีฏีกีถ ีคึีกีดีกีฏีกีถ ีฅีฏีกีดีธึีฟีจ ีฃีธีตีกีถีธึีด ีง ีฏีถีฝีกีฉีธีทีกีฏีซึึ*

ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีกีดีฅีถีกีกีฒึีกีฟ 10 ีฟีธีฏีธีฝีซ ีฐีซีดีถีกีฏีกีถ ีฅีฏีกีดีฟีซ ีกีฒีขีตีธึึีจ ีฏีฅีถีฝีกีฉีธีทีกีฏีถ ีง, ีธึีจ ีฏีกีฆีดีธึีด ีง ีดีซีถีนึ 85 ีฐีกีฆีกึ ีคึีกีด ีฝีฟีกึีธีฒ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีฟีซ 67 ีฟีธีฏีธีฝีจ, 12 ีฟีธีฏีธีฝีจี ีจีถีฟีกีถีฅีฏีกีถ ีถีบีกีฝีฟีถ ีง, ีซีฝีฏ ีกีทีญีกีฟีกีพีกึีฑีจี ีจีถีคีกีดีฅีถีจ 7 ีฟีธีฏีธีฝีจึ ีีทีฅีถึ ีธึ ีกีตีฝ ีญีดีขีธึีด ีดีฅีฏ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีกีถ ีฐีกีทีพีธีพ ีฏีฅีถีฝีกีฉีธีทีกีฏีซึ ีดีซีปีซีถ ีฅีฏีกีดีธึีฟีจ ีฏีกีฆีดีธึีด ีง 28 ีฐีกีฆีกึ ีคึีกีดึ ีีก ีนีซ ีถีทีกีถีกีฏีธึีด ีธึ ีกีตีฝ ีญีดีขีซ ีฉีธีทีกีฏีกีผีธึีถีฅึีจ ีดีซีปีซีถีจ ีฝีฟีกีถีธึีด ีฅีถ 28 ีฐีกีฆีกึ ีคึีกีดึ ีีกึีฆีกีบีฅีฝ ีธึีธีท ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึ ีกีตีฝ ีญีดีขีธึีด ีนีธึีถีฅีถ 63 ีกีถึ ีฉีธีทีกีฏีกีผีธึ ึ ีกีตีค ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีจ ีฏีฅีถีฝีกีฉีธีทีกีฏ ีนีฅีถ ีฝีฟีกีถีธึีดึ ีีธึีตีถีจ ีพีฅึีกีขีฅึีธึีด ีง ีกีทีญีกีฟีกีพีกึีฑีซึ ีฝีฟีกึีพีกีฎ ีดีซีปีซีถ ีฅีฏีกีดีฟีซีถึ ิธีฝีฟ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีขีกีฆีกีตีซ 2022-ีซีถ 63 ีกีถึ ีฉีธีทีกีฏีกีผีธึีถีฅึีซ ีดีธีฟ ีดีซีปีซีถ ีฏีฅีถีฝีกีฉีธีทีกีฏีจ ีฏีกีฆีดีธึีด ีง 46 245 ีคึีกีดึ

**ิณีฎีกีบีกีฟีฏีฅึ 2.** ิดีฅึีซีฌีกีตีซีถ ีญีดีขีฅึีซ ีฅีฏีกีดีฟีถีฅึีซ ีกีฒีขีตีธึึีถีฅึีจ, ีคึีกีด

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
income_deciles_drams
```


3-ีซึ 5-ึีค ีคีฅึีซีฌีกีตีซีถ ีญีดีขีฅึีซ ีคึีกีดีกีฏีกีถ ีฅีฏีกีดีธึีฟีซ ีกีพีฅีฌีซ ึีกีถ 10 ีฟีธีฏีธีฝีจ ีฝีฟีกีถีธึีด ีฅีถ ีขีกึีฅีฏีกีดีถีฅึีซึ, ีธึีธีถึ ีฃีฟีถีพีธึีด ีฅีถ ีกึีฟีกีฝีกีฐีดีกีถีธึีดึ ีีก ีกีดีฅีถีกีดีฅีฎ ีฟีฅีฝีกีฏีกึีกึ ีฏีทีซีผีถ ีงึ ิฑีตีฝ ีฅีฏีกีดีธึีฟีจ ีฝีฟีกึีพีธึีด ีง ีกึีฟีกีฃีถีก ีกีทีญีกีฟีธีฒีถีฅึีซึึ

ิปีถีนึีกีถ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีจ ีกีบีกีฐีธีพ ีง ีกีตีถึีกีถ ีดีฅีฎีกีถีธึีด ีง ีซีถึีถีกีฆีขีกีฒีพีกีฎีธึีฉีตีธึีถีซึ ีฏีกีด ีขีซีฆีถีฅีฝีซึ ีฝีฟีกึีพีกีฎ ีฅีฏีกีดีธึีฟีซ ีดีกีฝีถีกีขีกีชีซีถีจึ ีีธึีทีกีฃึีกีพ ีง ีกีตีถ ีธึ 10-ึีค ีญีดีขีธึีด, ีธึีจ ีถีฅึีฏีกีตีกึีถีธึีด ีง ีกีดีฅีถีกีกีบีกีฐีธีพ 10 ีฟีธีฏีธีฝีจ, ีกีทีญีกีฟีกีพีกึีฑีซึ ีฝีฟีกึีพีกีฎ ีฅีฏีกีดีธึีฟีซ ีฟีธีฏีธีฝีกีตีซีถ ีฏีทีซีผีจ ีกีพีฅีฌีซ ึีกีฎึ ีง, ึีกีถ 9-ึีค ีญีดีขีธึีดึ ิฑีดีฅีถีกีกีบีกีฐีธีพ ีญีกีพีจ ีกีผีกีถีฑีถีกีถีธึีด ีง ีซีถึีถีกีฆีขีกีฒีพีกีฎีถีฅึีซ ีฐีกีดีฅีดีกีฟีกีขีกึ ีดีฅีฎ ีฟีธีฏีธีฝีธีพึ ีีทีฅีถึ ีถีกึ ีธึ ีกีตีฝ ีญีดีขีซ ีฅีฏีกีดีฟีถีฅึีซ 1 ีฟีธีฏีธีฝีจ ีฑึีกีพีธึีพีธึีด ีง ีกีถีทีกึีช ีฃีธึีตึีซ ีพีกีณีกีผึีซึ, ีธึีจ ีฃีฎีกีบีกีฟีฏีฅึีธึีด ีถีฅึีกีผีพีกีฎ ีง "ีกีตีฌ ีฅีฏีกีดีธึีฟีถีฅึ" ีฝีกีถีคีฒีกีฏีธึีดึ

**ิณีฎีกีบีกีฟีฏีฅึ 3.** ิดีฅึีซีฌีกีตีซีถ ีญีดีขีฅึีซ ีฅีฏีกีดีฟีถีฅึีซ ีกีฒีขีตีธึึีถีฅึีจ, ีฟีธีฏีธีฝ

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
income_deciles_pct
```


*ีีทีธึีดโค ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฅีฏีกีดีธึีฟีถีฅึีจ ีฑึีกีพีธึีพีธึีด ีฅีถ ีคึีกีดีกีฏีกีถ ึ ีธีน ีคึีกีดีกีฏีกีถ ีกีฒีขีตีธึึีถีฅึีซึึ ิดีฅึีซีฌีกีตีซีถ ีญีดีขีฅึีจ ีฐีกีทีพีกึีฏีพีฅีฌ ีฅีถ ีจีถีคีฐีกีถีธึึ ีฅีฏีกีดีฟีซ ีฐีซีดีกีถ ีพึีกึ 2-ึีค ึ 3-ึีค ีฃีฎีกีบีกีฟีฏีฅึีถีฅึีจ ีกึีฟีกึีธีฌีธึีด ีฅีถ ีดีซีกีตีถ ีคึีกีดีกีฏีกีถ ีฅีฏีกีดีธึีฟีถีฅึีซ ีขีกีทีญีพีกีฎีธึีฉีตีธึีถีจ ีจีฝีฟ ีญีดีขีฅึีซึ ิฑีผีกีปีซีถ ีกีฒีตีธึีฝีกีฏีซ ีคีฅึีซีฌีกีตีซีถ ีญีดีขีฅึีซ ีดีซีปีซีถ ีฅีฏีกีดีธึีฟีจ ีฐีกีทีพีกึีฏีพีฅีฌ ีง ีฏีทีผีพีกีฎ ีดีฅีคีซีกีถีธีพึ 

ิฑีตีฝ ีพีฅึีฌีธึีฎีธึีฉีตีกีถ ีฟีพีตีกีฌีถีฅึีจ ีพีฅึึีพีกีฎ ีฅีถ ีบีกีทีฟีธีถีกีฏีกีถ ีกีฒีขีตีธึึีซึ, ีดีกีฝีถีกีพีธึีกีบีฅีฝี [ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฏีฅีถีฝีกีดีกีฏีกึีคีกีฏีซ (ีฏีฅีถีฝีกีบีกีตีดีกีถีถีฅึีซ) ีกีดีขีธีฒีปีกึีพีกีฎ ีฐีฅีฟีกีฆีธีฟีธึีฉีตีกีถ ีกีถีพีกีถีกีฆีฅึีฎีพีกีฎ ีดีซีฏึีธีฟีพีตีกีฌีถีฅึีซ ีขีกีฆีก (ีจีฝีฟ ีฟีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ)](https://www.armstat.am/en/?nid=205)ึ ีีถีกีตีซีถ ีฟีถีฟีฅีฝีธึีฉีตีธึีถีถีฅึีซ ีฏีฅีถีฝีกีดีกีฏีกึีคีกีฏีซ ึีธึึีกีถีซีทีถีฅึีจ ีฏีทีผีพีฅีฌ ีฅีถึ ีีกีทีพีกึีฏีถีฅึีจ ีฏีกึีฅีฌีซ ีง ีฝีฟีธึีฃีฅีฌ ีกีตึีฅีฌีฅีฌีธีพ [github-ีซ](https://github.com/tavad/tvyal_newsletter/tree/main/2024) ีดีฅึ ีงีปีจ, ีธึีฟีฅีฒ ีฟึีพีกีฎ ีฅีถ ีฟีพีตีกีฌีถีฅึีจ, ีฐีกีทีพีกึีฏีถีฅึีซ ึ ีฃีฎีกีบีกีฟีฏีฅึีถีฅึีซ ีฏีธีคีจึ









# 3. ิฑีทีญีกีฟีกีพีกึีฑีฅึีซ ีพีฅึีฌีธึีฎีธึีฉีตีธึีถ



```{r get raw data download 3, include=FALSE}

wages_raw <- 
  read_excel("2024_02_09_wages/wages_in_armenia_raw_2022.xlsx", skip = 2)

inflation_raw <- read_excel("2024_02_09_wages/cpi_armenia_eng.xls", skip = 3)

workers_n <- read_excel("2024_02_09_wages/wages_more_info.xlsx", sheet = "workers_n")

```

```{r data cleaning 3, include=FALSE}

max_year <- wages_raw |> colnames() |> parse_number() |> max(na.rm = TRUE)

inf_cumprod <- 
  inflation_raw |> 
  rename(date = 1, cpi_m = 2) |> 
  select(date, cpi_m) |> 
  mutate(
    date = ym(date),
    cpi_m = cpi_m / 100,
    year = year(date)
  ) |> 
  filter(year <= max_year) |>
  mutate(
    cpi_yoy = roll_prodr(cpi_m, 12)
  ) |>
  arrange(desc(date)) |> 
  mutate(
    adj_price = cumprod(cpi_m),
    adj_price = lag(adj_price),
    adj_price = ifelse(is.na(adj_price), 1, adj_price)
  ) |> 
  group_by(year) |> 
  filter(date == max(date)) |> 
  ungroup() |> 
  select(year, cpi_yoy, adj_price)


wages_clean <- 
  wages_raw |>
  filter(!is.na(`2020`))  |>  
  janitor::clean_names() |> 
  mutate(
    across(matches("\\d{4}"), ~ifelse(.x == "-", NA, .x)),
    across(matches("\\d{4}"), ~ as.numeric(.x))
  ) |> 
  mutate(
    indicator_arm = str_replace(indicator_arm, "ีกีทีญีกีฟีกีพีกึีฑ, ีคึีกีด", "ีกีทีญีกีฟีกีพีกึีฑ ีี ีจีถีคีฐีกีถีธึึ, ีคึีกีด"),
    indicator_arm = str_remove(indicator_arm, "ีีซีปีซีถ ีกีดีฝีกีฏีกีถ ีกีถีพีกีถีกีฏีกีถ ีกีทีญีกีฟีกีพีกึีฑีจ? ? ?-? ?\\(?"),
    indicator_arm = str_remove(indicator_arm, ", ีคึีกีด$"),
    indicator_arm = str_replace_all(indicator_arm, " *- *", " - "),
    
    indicator_eng = str_remove(indicator_eng, "Average monthly nominal wages? ? ?-? ?\\(? ?b?y? ?"),
    indicator_eng = str_replace_all(indicator_eng, " *- *", " - "),
  ) |> 
  extract(
    indicator_arm, into = c("ind1_arm", "ind2_arm"),
    regex = "(ีจีฝีฟ .*) - (.*)", remove = FALSE
  ) |> 
  extract(
    indicator_eng, into = c("ind1_eng", "ind2_eng"),
    regex = "(.*) - (.*)", remove = FALSE
  ) |> 
  # extract(ind1_arm, into = c("ind1", "ind2"),
  #         regex = "(ีจีฝีฟ .*) *- *(.*)", remove = FALSE) |> 
  # mutate(
  #   ind1 = ifelse(is.na(ind1), ind1_arm, ind1),
  #   
  # ) |> view()
  mutate(
    correction_2017 = x2017_2 / x2017,
    correction_2012 = x2012_2 / x2012,
  ) |> 
  select(-c(x2017_2, x2012_2)) |>
  pivot_longer( 
    cols = matches("^x\\d{4}$"),
    names_to = "year", values_to = "wages"
  ) |> 
  mutate(
    across(contains("ind"), ~str_trim(.x)),
    year = parse_number(year),
    wages_corrected = case_when(
      year <= 2012 & !is.na(correction_2017) ~ correction_2012 * correction_2017 * wages,
      year <= 2017 & year > 2012 & !is.na(correction_2017) ~ correction_2017 * wages,
      TRUE ~ wages
    )
  ) |> 
  left_join(inf_cumprod, by = "year") |> 
  mutate(wages_real = wages_corrected * adj_price) |> 
  select(-contains("correction"))


wages_clean |> write_excel_csv("wages_in_armenia_clean_2022.csv")

rm(wages_raw, inflation_row)

```


```{r main 3, include=FALSE}

 # provide 2 consecutive years that are in wages_clean
years_select = c(max_year - 1, max_year) 

date_legend <- 
  tibble(
    x = 215, y = c(1.5, 2.5), 
    color = c("#2f4b7c", "#f95d6a"), 
    text = rev(years_select),
    ind1_arm = "ีบีฅีฟีกีฏีกีถ",
    ind1_eng = "Public"
  )


wages_change_2021_22_plot <- 
  wages_clean |> 
  filter(grepl("RA Marzes and Yerevan", indicator_eng)) |> 
  mutate(
    ind1_arm = case_when(
      grepl("ีธีน ีบีฅีฟีกีฏีกีถ", ind1_arm) ~ "ีธีน ีบีฅีฟีกีฏีกีถ",
      grepl("ีบีฅีฟีกีฏีกีถ", ind1_arm) ~ "ีบีฅีฟีกีฏีกีถ",
      TRUE ~ "ีจีถีคีฐีกีถีธึึ"
    ),
    ind1_eng = case_when(
      grepl("Non - Public", ind1_eng) ~ "Non-Public",
      grepl("Public", ind1_eng) ~ "Public",
      TRUE ~ "Total"
    ),
    # ind2_eng = fct_relevel(ind2_eng, "Yerevan"),
    # ind2_arm = fct_relevel(ind2_arm, "ึ. ิตึึีกีถ")
  ) |> 
  filter(year %in% years_select) |> 
  select(ind1_arm, ind2_arm, ind1_eng, ind2_eng, year, wages_real) |> 
  mutate(
    wages_real = wages_real / 1000,
    year = ifelse(year == min(year), "begining", "end")
  ) |> 
  rename(marz_arm = ind2_arm, marz_eng = ind2_eng) |> 
  pivot_wider(names_from = year, values_from = wages_real) |> 
  mutate(
    marz_arm = fct_reorder(marz_arm, (begining + end)/2, .fun = mean),
    marz_eng = fct_reorder(marz_eng, (begining + end)/2, .fun = mean),
    color = ifelse(begining > end, "#f95d6a", "#2f4b7c"),
    ind1_eng = factor(ind1_eng, levels = c("Total", "Non-Public", "Public"))
  ) |> 
  ggplot() +
  facet_grid(~ind1_eng, scales = "free_x", space = "free_x") +
  geom_segment(
    aes(x = begining, xend = end,  y = marz_eng, 
        yend = marz_eng, group = ind1_eng, color = I(color)),
    linewidth = 1.2,
    lineend = "round", linejoin = "round",
    arrow = arrow(length = unit(0.1, "inches"))
  ) +
  geom_point(aes(x=begining, y=marz_eng, color=I("#f95d6a")), size = 3) +
  geom_point(aes(x=end, y=marz_eng, color=I("#2f4b7c")), size = 3) +
  geom_point(data = date_legend, aes(x, y, color = I(color)), size = 3) +
  geom_text(data = date_legend, aes(x + 15, y, label = text)) +
  scale_y_discrete() +
  labs(
    x = NULL,
    y = NULL,
    color = NULL,
    # title = "ีีซีปีซีถ ีกีดีฝีกีฏีกีถ ีกีถีพีกีถีกีฏีกีถ ีกีทีญีกีฟีกีพีกึีฑีจ ีจีฝีฟ ีดีกึีฆีฅึีซ ึ ีฟีถีฟีฅีฝีธึีฉีตีกีถ ีฐีกีฟีพีกีฎีถีฅึีซ",
    # subtitle = "ีีฅึีฏีกีตีกึีพีกีฎ ีฅีถ ีซึีกีฏีกีถ ีกีทีญีกีฟีกีพีกึีฑีฅึีจ, 2022 ีฉีพีกีฏีกีถีซ 8.3 ีฟีธีฏีธีฝ ีฃีถีกีณีธีพ ีณีทีฃึีฟีพีกีฎ\nีฐีกีฆีกึ ีี ีคึีกีด",
    # caption = paste0(caption_arm, "    |    ีฟีพีตีกีฌีถีฅึีซ ีกีฒีขีตีธึึ` armstat.am")
    title = "Average monthly salary by regions and sectors of the economy",
    subtitle = "Real nominal salaries, thousand AMD, 2021 is adjusted by 8.3% inflation in 2022",
    caption = paste0(caption_eng, "    |    Data Source: armstat.am")
  )


```


```{r plots 3,  include=FALSE}

wages_by_sector <- 
  wages_clean |> 
  filter(grepl("Types of Economic Activity", indicator_eng)) |>
  mutate(
    ind2_arm = str_trunc(ind2_arm, 30),
    ind2_eng = str_trunc(ind2_eng, 30)
  ) |> 
  filter(year %in% years_select) |> 
  select(ind1_arm, ind2_arm, ind1_eng, ind2_eng, year, wages_real) |> 
  mutate(
    wages_real = wages_real / 1000,
    year = ifelse(year == min(year), "begining", "end")
  ) |> 
  pivot_wider(names_from = year, values_from = wages_real) |> 
  mutate(
    ind2_arm = fct_reorder(ind2_arm, (begining + end)/2, .fun = mean),
    ind2_eng = fct_reorder(ind2_eng, (begining + end)/2, .fun = mean),
    color = ifelse(begining > end, "#f95d6a", "#2f4b7c")
  ) |> 
  ggplot() +
  geom_segment(
    aes(x = begining, xend = end,  y = ind2_eng, 
        yend = ind2_eng, group = ind1_eng, color = I(color)),
    linewidth = 1.2,
    lineend = 'round', linejoin = 'round',
    arrow = arrow(length = unit(0.1, "inches"))
  ) +
  geom_point(aes(x = begining, y = ind2_eng, color = I("#f95d6a")), size = 3) +
  geom_point(aes(x = end, y = ind2_eng, color = I("#2f4b7c")), size = 3) +
  geom_point(data = date_legend, aes(x + 400, y, color = I(color)), size = 3) +
  geom_text(data = date_legend, aes(x + 480, y, label = text)) +
  scale_x_log10(breaks = seq(0, 800, 100), limits =c(100, 800)) +
  scale_y_discrete() +
  labs(
    x = NULL,
    y = NULL,
    color = NULL,
    # title = "ีีซีปีซีถ ีกีดีฝีกีฏีกีถ ีกีทีญีกีฟีกีพีกึีฑีจ ีจีฝีฟ ีฟีถีฟีฅีฝีกีฏีกีถ ีฃีธึีฎีธึีถีฅีธึีฉีตีกีถ",
    # subtitle = "ีีฅึีฏีกีตีกึีพีกีฎ ีฅีถ ีซึีกีฏีกีถ ีกีทีญีกีฟีกีพีกึีฑีฅึีจ, 2022 ีฉีพีกีฏีกีถีซ 8.3 ีฟีธีฏีธีฝ ีฃีถีกีณีธีพ ีณีทีฃึีฟีพีกีฎ\nีกีถีพีกีถีกีฏีกีถ, ีฐีกีฆีกึ ีี ีคึีกีด",
    # caption = paste0(caption_arm, "    |    ีฟีพีตีกีฌีถีฅึีซ ีกีฒีขีตีธึึ` armstat.am")
    title = "Average Monthly Salary by Economic Activity",
    subtitle = "Real nominal salaries, thousand AMD, 2021 is adjusted by 8.3% inflation in 2022",
    caption = paste0(caption_eng, "    |    Data Source: armstat.am")
  )

```


```{r, include=FALSE}

pie_chart <- 
  workers_n |> 
  filter(year == max(year)) |>
  # filter(year %in% c(2019, 2022)) |>
  group_by(type, year) |> 
  mutate(
    workers_pct = workers_n / sum(workers_n),
    workers_pct_txt = percent(workers_pct, accuracy = 0.1),
    workers_pct_txt = ifelse(workers_pct >= 0.025, workers_pct_txt, NA),
    marz_arm = fct_reorder(marz_arm, workers_pct, .desc = TRUE),
    type = case_match(
      type,
      "non_public" ~ "ีีน ีบีฅีฟีกีฏีกีถ",
      "public" ~ "ีีฅีฟีกีฏีกีถ",
      "total" ~ "ิธีถีคีกีดีฅีถีจ"
    )
  ) |> 
  ggplot(aes(y = "1", x = workers_pct, fill = marz_arm, label = workers_pct_txt)) +
  geom_col() +
  geom_text(aes(y = 1.25), position = position_stack(vjust = .5)) +
  facet_grid(year~type, switch = "y") +
  coord_polar() +
  # ggthemes::scale_fill_stata() +
  scale_fill_manual(values = colfunc3(11)) +
  labs(
    x = NULL,
    y = NULL,
    fill = NULL,
    title = "ิฑีทีญีกีฟีธีฒีถีฅึีจ ีจีฝีฟ ีดีกึีฆีฅึีซ",
    subtitle = "ีีน ีบีฅีฟีกีฏีกีถ ึ ีบีฅีฟีกีฏีกีถ ีกีทีญีกีฟีกีฟีฅีฒีฅึโคโคโค",
    caption = paste0(caption_arm, "   |   source:armstat.am")
  ) +
  theme(
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_blank(),
    axis.text = element_blank()
  )

public_to_non_public_plot <- 
  workers_n |> 
  select(-mean_wage) |> 
  pivot_wider(names_from = type, values_from = workers_n) |> 
  mutate(
    non_public_to_public = non_public / public,
    non_public_to_public_txt = number(non_public_to_public, accuracy = 0.01),
    text_possition = ifelse(
      non_public_to_public > 1,
      non_public_to_public * 1.1,
      non_public_to_public / 1.1
    )
  ) |> 
  arrange(non_public_to_public) |> 
  filter(year == 2022) |> 
  mutate(
    marz_arm = fct_inorder(marz_arm),
    marz_eng = fct_inorder(marz_eng), 
  ) |> 
  ggplot(aes(non_public_to_public, marz_arm,
             fill = marz_arm, label = non_public_to_public_txt)) +
  geom_col() +
  geom_text(aes(x = text_possition)) +
  scale_x_log10() +
  scale_fill_manual(values = colfunc2(11)) +
  labs(
    x = NULL,
    y = NULL,
    title = "ีีน ีบีฅีฟีกีฏีกีถ ึ ีบีฅีฟีกีฏีกีถ ีกีทีญีกีฟีกีฟีฅีฒีฅึีซ ีฐีกึีกีขีฅึีธึีฉีตีธึีถีจ",
    subtitle = "2022ีฉโค, ีจีฝีฟ ีดีกึีฆีฅึีซ, ีฌีธีฃีกึีซีฉีดีซีฏ ีกีผีกีถึึ",
    caption = paste0(caption_arm, "   |   source:armstat.am")
  ) +
  theme(
    panel.grid.major.y = element_blank(),
    axis.text.x = element_blank(),
    legend.position = "none"
  )
```




[ิฑีิฝิฑีิฑีิฑีี ิตี ิฑีิฝิฑีีีีิตีิป ินีิฑีิฑีิฑิฟ -  2020-2022](https://www.armstat.am/file/article/lab_market_2023_14.pdf)

ีีี
ีญีธีฝีกีฌ ีดีซีปีซีถีซ ีธึ ีดีฅีคีซีกีถีซ ีฟีกึีขีฅึีธึีฉีตีกีถ ีดีกีฝีซีถ ึ ีฉีฅ ีซีถีนีธึ ีง ีดีฅีคีซีกีถีจ ีฅึีขีฅีดีถ ีกีพีฅีฌีซ ีฏีกึึีธึ ีกีทีญีกีฟีกีพีกึีฑีฅึีซ ีคีซีฟีกึีฏีดีกีถ ีฐีกีดีกึ, ึีกีถีซ ีธึ ีฐีกึีธึีฝีฟีถีฅึีจ ีฏีกึีธีฒ ีฅีถ ีฐีกึีฝีฟีกีถีกีฌ, ีซีฝีฏ ีดีซีปีซีถ ีญีกีพีจ ีถีธึีตีถีจ ีดีถีกีฝีฌึ
ีีี


ีจีถีคีกีถีธึึี 684783 ีดีกึีค ีกีทีญีกีฟีธีฒ 2022

ีีฅีฟีกีฏีกีถ ีธีฌีธึีฟีซ ีซึีกีฏีกีถ ีดีซีปีซีถ ีกีทีญีกีฟีกีพีกีฑีฅึีจ ีถีพีกีฆีฅีฌ ีฅีถ ีขีธีฌีธึ ีดีกึีฆีฅึีธึีด 2022 ีฉีพีกีฏีกีถีซีถึ ีีทีฅีถึ ีธึ 2022 ีฉีพีกีฏีกีถีซีถ ีบีฅีฟีกีฏีกีถ ีธีฌีธึีฟีธึีด ีกีทีญีกีฟีธึีด ีง ีจีถีคีกีถีธึึ ีกีทีญีกีฟีธีฒีถีฅึีซ 30 ีฟีธีฏีธีฝีจึ ิฑีตีฝ ีธีฌีธึีฟีซ ีดีซีปีซีถ ีกีทีญีกีฟีกีพีกึีฑีจ 2022 ีฉีพีกีฏีกีถีฅีถ ีฏีกีฆีดีธึีด ีงึ 186940 ีคึีกีด ีซีฝีฏ 2021-ีซีถี 179174 ีคึีกีด, ีกีถีพีกีถีกีฏีกีถ ีกีณีจี 4.3 ีฟีธีฏีธีฝ, ีฃีถีกีณีจี 8.3 ีฟีธีฏีธีฝ, ีซึีกีฏีกีถ ีกีณีจี -4 ีฟีธีฏีธีฝ ีกีถีฏีธึีดึ


**ิฑีฒีตีธึีฝีกีฏ 1.** 

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
wages_change_2021_22_plot
```


2022 ีฉีพีกีฏีกีถีซีถ ีีฅีฒีฅีฏีกีฟีพีธึีฉีตีธึีถ ึ ีฏีกีบ ีธีฌีธึีฟีธึีด ีกีทีญีกีฟีฅีฌ ีง 40301 ีดีกึีค, ีธึีจ ีฏีกีฆีดีฅีฌ ีง ีจีถีคีฐีกีถีธึึ ีกีทีญีกีฟีกีฟีฅีฒีฅึีซ 5.9 ีฟีธีฏีธีฝีจ, ีกีตีฝ ีธีฌีธึีฟีจ ีฝีฟีกีถีธึีด ีง ีกีดีฅีถีกีขีกึีฑึ ีดีซีปีซีถ ีกีทีญีกีฟีกีพีกึีฑีจี	748235ึ ีีทีฅีถึ ีธึ ีกีตีฝ ีธีฌีธึีฟีซ 71.1 ีฟีธีฏีธีฝีจ 2022 ีฉีพีกีฏีกีถีซีถ ีฏีกีฆีดีฅีฌ ีง ีี ีธีฌีธึีฟีจ (28668 ีดีกึีค)ึ ีี ีธีฌีธึีฟีซ ีดีซีปีซีถ ีกีทีญีกีฟีกีพีกึีฑีจ ีฅีฒีฅีฌ 917192 ีคึีกีดึ ิตีฉีฅ ีฐีกีถีฅีถึ ีี ีธีฌีธึีฟีจ ีีฅีฒีฅีฏีกีฟีพีธึีฉีตีธึีถ ึ ีฏีกีบีซึ ึ ีคีซีฟีกึีฏีฅีถึ ีดีซีกีตีถ ีฏีกีบีจ ีกีบีก ีดีซีปีซีถ ีกีทีญีกีฟีกีพีกึีฑีจ ีฏีกีบีธึีด ีฌีซีถีฅีฌีธึ ีง 331863 ีคึีกีดึ

ีีกึีคีฏีกีถึ ีฉีพีกึีกีถีกีฏีธีพ ีกีดีฅีถีกีดีฅีฎ ีธีฌีธึีฟีจ ีดีซีถีนึ 2021 ีฉีซีพีจ ีฏึีฉีธึีธึีถีถ ีงึ, ีกีตีฝีฟีฅีฒ ีง ีกีทีญีกีฟีธึีด 116445 ีดีกึีค, ีฏีกีด ีกีทีญีกีฟีธีฒีถีฅึีซ 17 ีฟีธีฏีธีฝีจึ 2022 ีฉีพีกีฏีกีถีซีถ ีกีผีกีปีซีถีจ ีจีฝีฟ ีกีทีญีกีฟีธีฒีถีฅึีซ ีฉีพีกึีกีถีกีฏีซ ีคีกึีฑีกีพ ีีฅีฎีกีฎีกีญ ึ ีดีกีถึีกีฎีกีญ ีกีผึีฟีธึึ, ีกีพีฟีธีดีฅึีฅีถีกีถีฅึีซ ึ ีดีธีฟีธึีซีฏีฌีถีฅึีซ ีถีธึีธีฃีธึีด, ีธึีฟีฅีฒ 2022 ีกีทีญีกีฟีธึีด ีงีซีถ 121953 ีดีกึีค ีฏีกีด 17.8 ีฟีธีฏีธีฝีจึ

ิฟึีฉีธึีฉีตีธึีถีจ ีกีดีฅีถีกีญีกีทีธึ ีธีฌีธึีฟีจ ีฌีซีถีฅีฌีธีพ ีธึ ีทีกีฟ ีฏีกึึีธึ ีธีฌีธึีฟ ีฌีซีถีฅีฌีธีพ ีีซีปีซีถ ีกีดีฝีกีฏีกีถ ีกีถีพีกีถีกีฏีกีถ ีกีทีญีกีฟีกีพีกึีฑีถ (ีฐีกึีฏีฅึีธีพ) ีบีฅีฟีกีฏีกีถ ีธีฌีธึีฟีธึีด 2022 ีฉ ีฏีกีฆีดีฅีฌ ีง ีจีถีคีกีดีฅีถีจ 132756 ีคึีกีด, 2021 ีฉี 128518 ีคึีกีดึ ิตีฉีฅ ีฐีกีทีพีซ ีกีผีถีฅีถึ ีธึ 2022 ีฉีพีกีฏีกีถีซ ีฃีถีกีณีจ ีฏีกีฆีดีฅีฌ ีง 8โค3 ีฟีธีฏีธีฝ, ีซีฝีฏ ีบีฅีฟีกีฏีกีถ ีธีฌีธึีฟีซ ีฏึีฉีธึีฉีตีกีถ ีกีทีญีกีฟีกีพีกึีฑีฅึีจ ีกีณีฅีฌ ีฅีถ 3.3 ีฟีธีฏีธีฝีธีพ, ีกีบีก ีซึีกีฏีกีถ ีกีทีญีกีฟีกีพีกึีฑึ ีกีตีฝ ีธีฌีธึีฟีธึีด ีซีปีฅีฌ ีง 5 ีฟีธีฏีธีฝีธีพึ

ีีซีถีกีถีฝีกีฏีกีถ ึ ีกีบีกีฐีธีพีกีฃึีกีฏีกีถ ีฃีธึีฎีธึีถีฅีธึีฉีตีธึีถ ีกีทีญีกีฟีธึีด ีง 21449 ีดีธึีคึ ิฑีตีฝ ีธีฌีธึีฟีซ ีกีทีญีกีฟีกีพีกึีฑีฅึีจ ีถีธึีตีถีบีฅีฝ ีธึีถีฅีถ ีผีฅีฏีธึีคีกีตีซีถ ีกีณึ


2019 ีฉีพีกีฏีกีถีซีถ ีกีทีญีกีฟีฟีฅีฒีฅึีซ 65.9 ีฟีธีฏีธีฝีจ ีฅึึีกีถีธึีด ีงึ 2022-ีซีถ ีกึีคีฅีถี 68.8 ีฟีธีฏีธีฝีจึ ีีซีดีถีกีฏีกีถีธึีด ีถีธึ ีกีทีญีกีฟีกีฟีฅีฒีฅึีจ ีกีผีกีปีกีถีธึีด ีฅีถ ีฅึึีกีถีธึีดึ

3 ีฟีกึีธึีดี 
ีดีกึีฆีฅึ 203929 213518 4.7 ีฟีธีฏีธีฝ ีกีณ, ีธีน ีบีฅีฟีกีฏีกีถ` 7.2 ีฟีธีฏีธีฝ ีกีณึ
ีีกึีฆีฅึีซึ ีกีดีฅีถีกีพีกีฟีจ ีกีตีฝ 3 ีฟีกึีธึีด ิผีธีผีซีธึีด ีง 2.5 ีฟีธีฏีธีฝ ีกีณ 3 ีฟีกึีพีก ีดีฅีปึ

ิตึึีกีถ 394308 471265 19.5 ีฟีธีฏีธีฝ ีกีณ, ีธีน ีบีฅีฟีกีฏีกีถ 24.5 ีฟีธีฏีธีฝ ีกีณ

ิป ีคีฅีบ ีบีฅีฟีกีฏีกีถ ีฃีธึีฎีจ ีกีดีฅีถีกีทีกีฟีจ ีกีณีฅีฌ ีง ิฑึีกึีกีฟีซ ีดีกึีฆีธึีด 10310 ีกีทีญีกีฟีธีฒีซึี 10975 ีกีทีญีกีฟีธีฒ 6.4 ีฟีธีฏีธีฝ ีกีณ, ีฐีฅีฟีธ ีถีธึ
ิตึึีกีถีธึีด 101 744 ีกีทีญีกีฟีธีฒีซึ 107 039 ีกีทีญีกีฟีธีฒี 5.2 ีฟีธีฏีธีฝ ีกีณึ






**ิณีฎีกีบีกีฟีฏีฅึ 2.** 

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
wages_by_sector
```



**ิณีฎีกีบีกีฟีฏีฅึ 3.** 

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
public_to_non_public_plot
```




**ิณีฎีกีบีกีฟีฏีฅึ 4.** 

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
pie_chart
```








