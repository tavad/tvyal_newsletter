---
title: "Tvyal Newsletter"
author: "Aghasi Tavadyan"
date: "2024-04-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(rvest)
library(RcppRoll)
library(scales)
library(readxl)

rm(list = ls()); gc()

theme_tvyal <- function(base_size = 12, base_family = "sans")
{
  colors <- deframe(ggthemes::ggthemes_data[["fivethirtyeight"]])
  (ggthemes::theme_foundation(
    base_size = base_size, base_family = base_family) +
      theme(
        line = element_line(colour = "black"),
        rect = element_rect(fill = "white", linetype = 0, colour = NA),
        text = element_text(colour = colors["Dark Gray"]),
        # axis.title = element_blank(),
        # axis.text = element_text(),
        axis.ticks = element_blank(),
        axis.line = element_blank(),
        legend.background = element_rect(),
        legend.position = "bottom",
        legend.direction = "horizontal",
        legend.box = "vertical",
        panel.grid = element_line(colour = NULL),
        panel.grid.major.x = element_line(
          colour = colors["Medium Gray"], 
          linetype = "dotted"
        ),
        panel.grid.major.y = element_line(
          colour = colors["Medium Gray"], 
          linetype = "dotted"
        ),
        panel.grid.minor = element_blank(),
        plot.title = element_text(hjust = 0, size = rel(1.5), face = "bold"),
        plot.margin = unit(c(1, 1, 1, 1), "lines"), strip.background = element_rect()
      )
  )
}

theme_set(theme_tvyal())

save_last_plot <-
  function(filename, extension = "png", width = 1008, height = 567) {

    filename <- str_replace_all(filename, " ", "_")
    last_plot <- recordPlot()

    if (extension == "png") {
      png(paste0(filename, ".", extension), width = width, height = height)
    } else if (extension == "pdf") {
      pdf(paste0(filename, ".", extension), width = width, height = height)
    } else {
      stop("Unsupported file extension. Use 'png' or 'pdf'.")
    }

    replayPlot(last_plot)
    dev.off()
    paste0(filename, ".", extension)
  }

new_palette_colors <- c(
  "#003f5c", "#2f4b7c", "#665191", "#a05195",
  "#d45087", "#f95d6a", "#ff7c43", "#ffa600"
)
colfunc <- colorRampPalette(c("#2f4b7c", "#fffcf5", "#f95d6a"))
colfunc2 <- colorRampPalette(new_palette_colors)
colfunc3 <- colorRampPalette(c("#005C4B", new_palette_colors, "#FFD17A", "#FFFCF5"))

update_geom_defaults("rect", list(fill  = new_palette_colors[2], alpha = 0.8))
update_geom_defaults("line", list(color = new_palette_colors[2], alpha = 0.8))
update_geom_defaults("area", list(fill  = new_palette_colors[2], alpha = 0.8))

caption_arm <-  "Հեղինակ` Աղասի Թավադյան   |   tvyal.com   |   tavadyan.com"
caption_eng <-  "Author: Aghasi Tavadyan   |   tvyal.com   |   tavadyan.com"

doParallel::registerDoParallel(cores = 8)

Sys.setlocale("LC_TIME", "hy_AM.UTF-8")

setwd(dirname(rstudioapi::getActiveDocumentContext()$path))

```

```{r get FX data, include=FALSE}

CBA_FX_data <- read_csv("CBA_FX_data_cleaned.csv")

exchange_points <- read_csv("rate_by_exchange_points.csv")

```




```{r , include=FALSE}

USD_EUR_RUR_plot <- 
  CBA_FX_data |> 
  filter(year >= 2010) |> 
  filter(FX_ISO %in%  c("USD", "EUR", "RUB")) |> 
  mutate(AMD = ifelse(FX_ISO == "RUB", AMD * 50, AMD)) |> 
  ggplot(aes(date, AMD, color = FX_ISO)) +
  geom_line(size = 1.2) +
  scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
  scale_y_continuous(
    breaks = seq(200, 700, 100),
    name = "USD, EUR",
    sec.axis = sec_axis(
      transform = ~ . / 50,
      breaks = seq(4, 14, 2), 
      name = "RUB"
    )
  ) +
  scale_color_manual(values = new_palette_colors[c(2,6,8)]) +
  labs(
    y = NULL,
    color = NULL,
    title = "Փոխարժեքները․․․",
    # subtitle = "USD / AMD, EUR / AMD, RUB / AMD",
    caption =  paste(
      caption_arm, "   |   Տվյալների աղբյուր՝ cba.am"
    )
  )

```



```{r story of USD / AMD, include=FALSE}

rect_data_2 <- 
  tibble(
    xmin = ymd("2020-09-27", "2020-11-09", "2023-09-19", "2023-09-25"), 
    xmax = ymd("2020-11-09", "2021-08-01", "2023-09-25", "2024-04-01"), 
    ymin = c(480, 480, 380, 380), 
    ymax = c(540, 540, 410, 410),
    text = c(
      "2020, 44-օրյա պատերազմի ազդեցությունը",
      "Հետպատերազմյան շրջան",
      "2023, Ադրբեջանի Արցախի գրավման ազդեցությունը",
      "Հետպատերազմյան շրջան"
    )
  )

story_of_USD_AMD_plot <- 
  CBA_FX_data |> 
  filter(year >= 2012) |> 
  filter(FX_ISO %in%  c("USD")) |> 
  mutate(
    ellips_1 = case_when(
      date >= ymd("2012-06-01") &  date <= ymd("2014-11-01") ~ "a_stability1",
      date >= ymd("2015-01-01") &  date <= ymd("2020-08-01") ~ "b_stability2",
      date >= ymd("2023-02-15") &  date <= ymd("2023-09-18") ~ "c_stability3",
      TRUE ~ NA
    ),
    ellips_1_AMD = ifelse(!is.na(ellips_1), AMD, NA),
    # ellips_2 = case_when(
    #   date >= ymd("2020-09-01") &  date <= ymd("2021-09-01") ~ "ellipse_4",
    #   date >= ymd("2023-09-01") &  date <= ymd("2024-09-01") ~ "ellipse_5",
    #   TRUE ~ NA
    # ),
    # ellips_2_AMD = ifelse(!is.na(ellips_2), AMD, NA),
    ellips_3 = case_when(
      date >= ymd("2014-11-01") &  date <= ymd("2014-12-30") ~ "d_crisis1",
      date >= ymd("2022-03-11") &  date <= ymd("2022-09-15") ~ "e_crisis2",
      TRUE ~ NA
    ),
    ellips_3_AMD = ifelse(!is.na(ellips_3), AMD, NA),
    peaks = case_when(
      date == ymd("2014-12-17") ~ "Ցնցում N1",
      date == ymd("2022-03-11") ~ "Ցնցում N2",
      date == ymd("2023-10-04") ~ "Ցնցում N3",
    )
  ) |> 
  ggplot() +
  geom_rect(
    data = rect_data_2,
    mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax, fill = text),
    alpha = 0.5
  ) +
  stat_ellipse(aes(date, ellips_3_AMD, color = ellips_3), na.rm = TRUE, linetype = 2) +
  geom_line(aes(date, AMD), linewidth = 0.8, color = new_palette_colors[1]) +
  geom_line(aes(date, ellips_1_AMD, color = ellips_1), linewidth = 1.2) +
  geom_text(aes(date, AMD, label = peaks),  hjust = -0.1) +
  # stat_ellipse(aes(date, ellips_2_AMD, color = ellips_2), na.rm = TRUE, linetype = 2) +
  scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
  scale_y_continuous(breaks = seq(340, 600, 20)) +
  scale_color_manual(
    values = new_palette_colors[c(4,5,6,7,8)], na.value = "transparent",
    labels = c(
      "2.5 տարվա կայունություն (2012-2014)", "5.5 տարվա կայունություն (2015-2020)",
      "7 ամսվա կայունություն (2023)",
      "Արժութային ճգնաժամ Ռուսաստանում (2014-2015)",
      "Ռուսաստանի դեմ պատժամիջոցներ (2022)",
      "")
  ) +
  scale_fill_manual(values = new_palette_colors[c(5,6,2)]) +
  labs(
    x = NULL,
    y = NULL,
    fill = NULL,
    color = NULL,
    title = "ԱՄՆ դոլար ՀՀ դրամ. փոխարժեքի դինամիկայի ուսումնասիրություն",
    subtitle = "USD / AMD",
    caption =  paste(
      caption_arm, "   |   Տվյալների աղբյուր՝ cba.am"
    )
  ) +
  guides(
    color = guide_legend(nrow = 2, byrow = TRUE, order = 1)
  )
```



```{r loss of Artsakh and FX, include=FALSE}


rect_data <- 
  tibble(
      xmin=ymd("2020-09-27", "2023-09-19"), 
      xmax=ymd("2020-11-09", "2023-09-25"), 
      ymin=c(480, 380), 
      ymax=c(540,430), 
      war_period = c("2020 44-օրյա պատերազմի ազդեցությունը", "2023 Ադրբեջանի Արցախի գրավման ազդեցությունը")
      # alpha = 0.5, fill = new_palette_colors[6], color = "#FFFFFF00"
  )

artsakh_and_FX_plot <- 
  CBA_FX_data |> 
  mutate(year = year(date)) |> 
  filter(FX_ISO %in% c("USD"), year >= 2019) |>
  bind_rows(
    tibble(
      date = ymd("2024-08-01"),
      FX_ISO = "none",
      AMD = 380,
      year = 2024
    )
  ) |> 
  mutate(
    war_period = case_when(
      date >= ymd("2020-08-01") & date <=  ymd("2021-08-01") 
      ~ "2020 44-օրյա պատերազմի ազդեցությունը",
      date >= ymd("2023-08-01") & date <=  ymd("2024-08-01") 
      ~ "2023 Ադրբեջանի Արցախի գրավման ազդեցությունը",
    )
  ) |>
  filter(!is.na(war_period)) |>
  ggplot() +
  geom_rect(
    data = rect_data,
    mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax, fill = war_period),
    alpha = 0.5
  ) +
  geom_line(aes(date, AMD, color = FX_ISO), linewidth = 1.5) +
  facet_wrap(~war_period, nrow = 2, scales = "free") +
  scale_x_date(date_breaks = "1 month", date_labels = "%b-%y") +
  scale_y_continuous(n.breaks = 8) +
  scale_color_manual(values = new_palette_colors) +
  scale_fill_manual(values = new_palette_colors[c(6,5)]) +
  labs(
    x = NULL,
    y = NULL,
    color = NULL,
    title = "Արցախի կորուստի ազդեցությունը փոխարժեքի վրա",
    subtitle = "USD / AMD",
    caption =  paste(
      caption_arm, "   |   Տվյալների աղբյուր՝ cba.am"
    )
  ) +
  theme(
    legend.position = "drop"
  )

```




```{r exchange points plot, include=FALSE}

exchange_points_plot <- 
  exchange_points |> 
  mutate(
    possition_arm = ifelse(possition == "buy", "առք", "վաճառք")
  ) |> 
  # filter(FX %in% c("EUR", "RUB")) |> 
  filter(FX %in% c("USD")) |> 
  ggplot() +
  geom_line(aes(date, value, color = possition_arm)) +
  facet_wrap(~FX, scales = "free_y") +
  scale_x_datetime(date_breaks = "2 days", date_labels = "%b %d") +
  scale_color_manual(values = new_palette_colors[c(6,4)]) +
  labs(
    x = NULL,
    y = NULL,
    color = NULL,
    title = "Փոխարժեքը կայունանո՞ւմ է",
    subtitle = "Փոխարժեքը Երևանի փոխանակման կետերում, ապրիլի 4, 18։00 դրությամբ",
    caption =  caption_arm
  )

```

```{r , include=FALSE}



```



***English summary below.***

Հարգելի գործընկեր,

Հուսով եմ լավ եք:
Ներկայացնում եմ այս շաբաթվա վերլուծությունները և աշխատանքները.

**ՈՒՇԱԴՐՈՒԹՅՈՒՆ․ ՄԵՆՔ !!PODCAST!! ՈՒՆԵՆՔ․ ՄԱՆՐԱՄԱՍՆԵՐԸ ՆԵՐՔԵՎՈՒՄ**


## 🌿🤨💎 


**Գծապատկեր 1.**  

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 12, fig.height = 8}
USD_EUR_RUR_plot
```



>
> Կարդացեք թե որ ճյուղերն են նպաստում տնտեսական աճին․
>
> [🇦🇲📊🏗️ Հայաստանի 2023թ․ 8.7% տնտեսական աճի հիմնական պատճառները](https://www.tvyal.com/newsletter/2024/2024_03_09)։
>




**Գծապատկեր 2.** 

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 12, fig.height = 8}
story_of_USD_AMD_plot
```




>
> Ձեզ կարող է հետաքրքրել նաև հետևյալ վերլուծությունը.
>
> [🚜🌾📉 10 տարվա գյուղատնտեսության կոլափսը](https://www.tvyal.com/newsletter/2024/2024_03_15)։
>


**Գծապատկեր 3.** 

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 12, fig.height = 8}
artsakh_and_FX_plot
```



**Գծապատկեր 4.** 

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 12, fig.height = 8}
exchange_points_plot
```



**Գծապատկեր 5.** 

```{r, echo=FALSE, warning=FALSE, message=FALSE, fig.width = 12, fig.height = 8}

```




>
> Կարդացեք թե որ ճյուղերն են նպաստում տնտեսական աճին․
>
> [💸🔚🏦 Կապիտալի արտահոսք](https://www.tvyal.com/newsletter/2024/2024_03_01)։
>


## PODCAST !!

### Խոսենք թվերով #2

[Բարձր տնտեսական ակտիվությունը Հայաստանում․ Ինչի՞ հաշվին](https://www.youtube.com/watch?v=0dnlgdqfMrM)

- 🔘 Տնտեսական ակտիվության ցուցանիշը փետրվարին
- 🔘 Ի՞նչ է թաքնված բարձր ցուցանիշի հետևում
- 🔘 Ո՞ր ոլորտներն են աճ գրանցում
- 🔘 Ինչպիսին կլինի տնտեսական աճը Հայաստանում

How2B-ում «խոսում ենք թվերով»՝ տնտեսագետ Աղասի Թավադյանի հետ:

Թեմայով վերլուծությունը ներկայացված է tvyal.com կայքում՝
[🌿🤨💎 Թանկարժեք էֆեկտ․ 2024 թվականի տնտեսական աճի պատճառները](https://www.tvyal.com/newsletter/2024/2024_03_29)

<a href="https://www.youtube.com/watch?v=0dnlgdqfMrM">
  <img src="https://i3.ytimg.com/vi/0dnlgdqfMrM/hqdefault.jpg" alt="YouTube Video" style="width:60%;">
</a>


<!-- ## ԶԼՄ հաղորդագրություն -->


<!-- [Դիտեք 1in.am-ին տված իմ վերջին հարցազրույցը, որտեղ խոսում եմ 2024 թվականի տնտեսական մարտահրավերների մասին։](https://youtu.be/wk07vyuAnnU?t=222) -->

<!-- 📺  Հարցազրույցը արդեն դիտել է 10 000 մարդ 📺 -->

<!-- Հարցազրույցում շոշափվել են հետևյալ թեմաները։ -->

<!-- - 🎯 Ինչ հնարավոր վտանգներ տնտեսության համար, ինչը կարող է խաթարել պլանավորված 7 տոկոս տնտեսական աճը։ -->
<!-- - 🎯 Ինչով է պայմանավորված վերաարտահանման աճը։ 25 տոկոս ոսկի և ադամանդներ արտահանման մե՞ջ։ -->
<!-- - 🎯 Շինարարական բում Հայաստանում՝ կառավարությունը կրկնում է 2002-2007 թվականներին սխալները։ -->
<!-- - 🎯 Ի՞նչ առավելություններ կտա Եվրոպական ուղին Հայաստանի տնտեսության համար։ -->


<!-- <a href="https://youtu.be/wk07vyuAnnU?t=222"> -->
<!--   <img src="https://i3.ytimg.com/vi/wk07vyuAnnU/hqdefault.jpg" alt="YouTube Video" style="width:60%;"> -->
<!-- </a> -->



## English Summary

### 🌿🤨💎 



---

Այս վերլուծությունը առկա է նաև [մեր կայքէջում](https://www.tvyal.com/newsletter/2024/2024_04_05), այս վերլուծության կոդը և տվյալները դրված են նաև [Github-ում](https://github.com/tavad/tvyal_newsletter)։       

---                  

Եթե հնարավոր է, խնդրում եմ այս նյութը ուղարկել նաև այն մարդկանց, ում այն կարծում եք կարող է հետաքրքրել:

Սպասեք հաջորդ հաղորդագրությանը հաջորդ ուրբաթ օրը:      


Հարգանքներով,            
Աղասի Թավադյան         
05.04.2024          
[tvyal.com](https://www.tvyal.com/)      
[tavadyan.com](https://www.tavadyan.com/)

---

[Was this email forwarded to you? Subscribe here.](https://www.tvyal.com/subscribe)

[Բաժանորդագրվեք](https://www.tvyal.com/subscribe)

       
---              
               


####### **Ուշադրություն. Ձեր էլ.փոստը մեյլիսթի մեջ է, որի միջոցով ես կիսվում եմ շաբաթական նյութեր, որոնք հիմնականում ներկայացնում են Հայաստանի տնտեսությանը: Նյութերը ներառում են գծապատկերներ, [տվյալների բազաներ](https://github.com/tavad/tvyal_newsletter), տեսանյութեր, հոդվածներ, [առցանց վահանակներ](https://www.tvyal.com/projects), տնտեսական գործիքներ, կանխատեսումներ և հաշվետվություններ: Եթե ցանկանում եք չեղարկել բաժանորդագրությունը, խնդրում եմ տեղեկացրեք ինձ, և ես կհեռացնեմ ձեր էլ. փոստը ցուցակից: Գրեք նաև եթե ունեք մենկնաբանություններ:**

####### **Important! Your email is part of the mailing list where I share weekly materials primarily focused on the Armenian economy. These materials encompass charts, [databases](https://github.com/tavad/tvyal_newsletter), videos, articles, [online dashboards](https://www.tvyal.com/projects), economic tools, forecasts, and reports. If you wish to unsubscribe, please let me know, and I will remove your email from the list. Please share your comments as well․**





