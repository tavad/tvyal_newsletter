---
title: "Tvyal Newsletter"
author: "Aghasi Tavadyan"
date: "2024-01-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(scales)
library(countrycode)
library(patchwork)
library(ggstream)

rm(list = ls()); gc()

theme_tvyal <- function(base_size = 12, base_family = "sans") 
{
  colors <- deframe(ggthemes::ggthemes_data[["fivethirtyeight"]])
  (ggthemes::theme_foundation(
    base_size = base_size, base_family = base_family) + 
      theme(
        line = element_line(colour = "black"), 
        rect = element_rect(fill = "white", linetype = 0, colour = NA),
        text = element_text(colour = colors["Dark Gray"]), 
        # axis.title = element_blank(),
        # axis.text = element_text(), 
        axis.ticks = element_blank(),
        axis.line = element_blank(), 
        legend.background = element_rect(), 
        legend.position = "bottom", 
        legend.direction = "horizontal", 
        legend.box = "vertical", 
        panel.grid = element_line(colour = NULL), 
        panel.grid.major = element_line(colour = colors["Medium Gray"]), 
        panel.grid.minor = element_blank(), 
        plot.title = element_text(hjust = 0, size = rel(1.5), face = "bold"),
        plot.margin = unit(c(1, 1, 1, 1), "lines"), strip.background = element_rect()
      )
  )
}

theme_set(theme_tvyal())

save_last_plot <- 
  # function(filename, extension = "png", width = 1344, height = 756) {
  function(filename, extension = "png", width = 1008, height = 576) {
    
    filename <- str_replace_all(filename, " ", "_")
    last_plot <- recordPlot()
    
    if (extension == "png") {
      png(paste0(filename, ".", extension), width = width, height = height)
    } else if (extension == "pdf") {
      pdf(paste0(filename, ".", extension), width = width, height = height)
    } else {
      stop("Unsupported file extension. Use 'png' or 'pdf'.")
    }
    
    replayPlot(last_plot)
    dev.off()
    paste0(filename, ".", extension)
  }

new_palette_colors <- c(
  "#003f5c", "#2f4b7c", "#665191", "#a05195", 
  "#d45087", "#f95d6a", "#ff7c43", "#ffa600"
)
colfunc   <- colorRampPalette(c("#2f4b7c", "#fffcf5", "#f95d6a"))
colfunc_2 <- colorRampPalette(c("#005C4B", new_palette_colors,  "#FFC251", "#FFDFA3", "#FFFCF5"))


update_geom_defaults("rect", list(fill  = new_palette_colors[2], alpha = 0.8)) 
update_geom_defaults("line", list(color = new_palette_colors[2], alpha = 0.8))
update_geom_defaults("area", list(fill  = new_palette_colors[2], alpha = 0.8))

caption_arm <-  "Հեղինակ` Աղասի Թավադյան   |   tvyal.com   |   tavadyan.com"
caption_eng <-  "Author: Aghasi Tavadyan   |   tvyal.com   |   tavadyan.com"

doParallel::registerDoParallel(cores = 8)

setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
```

```{r data download, include=FALSE}

auto_trade_armenia <- read_csv("auto_trade_armenia.csv")

auto_trade_georgia <- read_csv("auto_trade_georgia.csv")


```


```{r, include=FALSE}

auto_trade_armenia |> 
  filter(aggregate_level == 4) |> 
  group_by(trade_flow, year) |> 
  summarise(Qty = sum(Qty), .groups = "drop") |> 
  mutate(Qty = round(Qty)) |> 
  pivot_wider(names_from = "trade_flow", values_from = "Qty") |> 
  knitr::kable()
```

```{r, include=FALSE}
auto_trade_armenia |>
  filter(
    year == 2023,
    aggregate_level == 4,
    trade_code == "M"
  ) |> 
  left_join(
    transmute(countrycode::codelist,
              partner_iso = iso3c, partner_am = cldr.name.hy),
    by = join_by(partner_iso)
  ) |> 
  mutate(
    partner = fct_lump_n(partner, 10, w = trade_value_us, 
                         other_level = "Other counties"),
    partner_am = ifelse(is.na(partner_am), "Այլ պետություններ", partner_am),
    partner_am = fct_lump_n(partner_am, 10, w = trade_value_us, 
                            other_level = "Այլ պետություններ")
  ) |> 
  group_by(partner) |> 
  summarise(trade_value_us = sum(trade_value_us)) |> 
  ungroup() |> 
  mutate(pct = trade_value_us / sum(trade_value_us)) |> 
  arrange(desc(pct))
```


```{r, include=FALSE}

# Kazakhstan         United Kingdom     Canada             China             
#  [5] Rep. of Korea      Mexico             Germany            Japan             
#  [9] USA                Russian Federation Other counties  

trade_smooth_plotter <- 
  function(
    tbl, trade_code_, lumps, year_start = 2021, facet_label, ...
  ){
    
    smooth_plot <- 
      tbl |> 
      filter(
        trade_code %in% trade_code_,
        year >= year_start,
        aggregate_level == 4
      ) |> 
      mutate(
        partner = fct_lump_n(partner, lumps, w = Qty, 
                             other_level = "Other counties"),
      ) |> 
      group_by(period, partner, trade_code, trade_flow) |> 
      summarise(Qty = sum(Qty), .groups = "drop") |> 
      mutate(
        partner = fct_reorder(partner, Qty, .fun = sum, .desc = TRUE),
        partner = fct_relevel(partner, "Other counties", after = Inf)
      ) |> 
      ggplot(aes(period, Qty, fill = partner)) + 
      geom_stream(...) +
      scale_x_date(
        date_breaks = "1 year", date_labels = "%Y",
        limits = c(as.Date(paste0(year_start, "-01-01")), as.Date("2024-01-01"))
      ) +
      scale_y_continuous(labels = number_format(), n.breaks = 8) +
      scale_fill_manual(values = colfunc_2(lumps + 1)) +
      guides(fill = guide_legend(nrow = 2, byrow = TRUE)) +
      labs(
        x = NULL,
        y = NULL,
        fill = NULL,
        subtitle = facet_label
      ) +
      theme(
        plot.subtitle = element_text(hjust = 0.5),
        panel.grid.major.x = element_blank()
      )
    
    return(smooth_plot)
  }

# 
# auto_trade_armenia_plot <- 
#   auto_trade_armenia |> 
#   auto_trade_partners_lumpped(lump = 10) |> 
#   ggplot(aes(period, Qty, fill = partner)) + 
#   geom_col() +
#   facet_wrap(~trade_flow) +
#   scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
#   scale_y_continuous(labels = number_format(), n.breaks = 8) +
#   # scale_fill_brewer(type = "qual", palette = 3) +
#   scale_fill_manual(values = colfunc_2(11)) +
#   labs(
#     x = NULL,
#     y = NULL,
#     fill = NULL,
#     # title = "Մեքենաների առևտուրը թափ է՞ հավաքում, թե՞ պարապ ընթացքի մեջ է",
#     title = "Ավտոմեքենաների ներմուծմումը և արտահանումը Հայաստանում",
#     # title = "Ավտոմեքենաների ներմուծմումը և արտահանումը Վրաստանում",
#     subtitle = "միավոր, ԱՏԳ ԱԱ դասակարգչ 8703",
#     caption = paste0(caption_eng, "    |    Data Source: Comtrade")
#   )
#   
# 
# auto_trade_georgia_plot <- 
#   auto_trade_georgia |> 
#   auto_trade_partners_lumpped(lump = 10) |> 
#   ggplot(aes(period, Qty, fill = partner)) + 
#   geom_col() +
#   facet_wrap(~trade_flow) +
#   scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
#   scale_y_continuous(labels = number_format(), n.breaks = 8) +
#   # scale_fill_brewer(type = "qual", palette = 3) +
#   scale_fill_manual(values = colfunc_2(11)) +
#   labs(
#     x = NULL,
#     y = NULL,
#     fill = NULL,
#     # title = "Մեքենաների առևտուրը թափ է՞ հավաքում, թե՞ պարապ ընթացքի մեջ է",
#     title = "Ավտոմեքենաների ներմուծմումը և արտահանումը Վրաստանում",
#     # title = "Ավտոմեքենաների ներմուծմումը և արտահանումը Վրաստանում",
#     subtitle = "միավոր, ԱՏԳ ԱԱ դասակարգչ 8703",
#     caption = paste0(caption_eng, "    |    Data Source: Comtrade")
#   )
#   


```

```{r, include=FALSE}
# auto_trade_armenia |> 
#   filter(trade_code == "M") |> 
#   auto_trade_partners_lumpped(lump = 7) |> 
#   group_by(period, partner) |> 
#   summarise(Qty = sum(Qty)) |> 
#   ungroup() |> 
#   ggplot(aes(period, Qty, fill = partner)) + 
#   geom_area() +
#   scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
#   scale_y_continuous(labels = number_format(), n.breaks = 8) +
#   scale_fill_manual(values = colfunc_2(8)) +
#   guides(fill=guide_legend(nrow=2,byrow=TRUE)) +
#   labs(
#     x = NULL,
#     y = NULL,
#     fill = NULL,
#     subtitle = "Export"
#   ) +
#   theme(plot.subtitle = element_text(hjust = 0.5))
```


```{r, include=FALSE}

plot_armenia_imports_2017 <- 
  auto_trade_armenia |> 
  trade_smooth_plotter(
    trade_code_ = "M", lumps = 7, year_start = 2017,
    facet_label = "Import",
    type = "ridge", bw=0.55, n_grid = 5000, extra_span = 0.15
  ) +
  labs(
    title = "Armenia's Vehicle Export",
    subtitle = "Units in a Month, HS code 8703",
    caption = paste0(caption_eng, "    |    Data Source: Comtrade")
  ) +
  theme(
     plot.subtitle = element_text(hjust = 0)
  )

plot_armenia_imports <- 
  auto_trade_armenia |> 
  trade_smooth_plotter(
    trade_code_ = "M", lumps = 7, year_start = 2021,
    facet_label = "Import",
    type = "ridge", bw=0.75, n_grid = 5000, extra_span = 0.15
  )

plot_armenia_exports <- 
  auto_trade_armenia |> 
  trade_smooth_plotter(
    trade_code_ = "X", lumps = 3, year_start = 2021,
    facet_label = "Export",
    type = "ridge", bw=0.75, n_grid = 5000, extra_span = 0.15
  )



auto_trade_armenia_plot <- 
  plot_armenia_imports +
  plot_armenia_exports +
  plot_layout(ncol = 2) +
  plot_annotation(
    title = "Armenia's Vehicle Trade",
    subtitle = "Units in a Month, HS code 8703",
    caption = paste0(caption_eng, "    |    Data Source: Comtrade")
  )

```


```{r, include=FALSE}

plot_georgia_imports <- 
  auto_trade_georgia |> 
  trade_smooth_plotter(
    trade_code_ = "M", lumps = 6, year_start = 2021,
    facet_label = "Import",
    type = "ridge", bw=0.75, n_grid = 5000, extra_span = 0.15
  )

plot_georgia_exports <- 
  auto_trade_georgia |> 
  trade_smooth_plotter(
    trade_code_ = "X", lumps = 6, year_start = 2021,
    facet_label = "Export",
    type = "ridge", bw=0.75, n_grid = 5000, extra_span = 0.15
  )

auto_trade_georgia_plot <- 
  plot_georgia_imports +
  plot_georgia_exports +
  plot_layout(ncol = 2) +
  plot_annotation(
    title = "Georgia's Vehicle Trade",
  subtitle = "Units in a Month, HS code 8703",
    caption = paste0(caption_eng, "    |    Data Source: Comtrade")
  )

```


***English summary below.***

Հարգելի գործընկեր,

Հուսով եմ լավ եք:
Ներկայացնում եմ այս շաբաթվա վերլուծությունները և աշխատանքները.

1. "Ավտոարտադրույան" մահը Հայաստանում
2. ԶԼՄ հաղորդագրություններ
3. English summary


## 1. "Ավտոարտադրույան" մահը Հայաստանում




Ավտոմեքենաների ներմուծման մասին:

Չեք նկատել որ մեքենաները փողոցներում գրեթե կրկնապատկվել են:

2021-ին ներմուծվել է 7362 թեթև մարդատար ավտոմեքենա, ապա 2022-ին արդեն՝ 42 293 ավտոմեքենա: Այսինքն մոտ 6 անգամ աճ է տեղի ունեցել: 2021-ին Հայաստանից արտահանել է 319 մեքենա, իսկ 2022-ին՝ 10936 ավտոմեքենա: Այսպիսով ներմուծված մեքենաների քառորդը վերաարտահանել ենք հիմնականում Ռուսաստան: Գրանցվել է ԱՄՆ-ից մեքենաների ներմուծման զգալի աճ` մոտ 7 անգամ 2022թ. ընթացքում։ 

Այս մասին տվել եմ հարցազրույց` https://www.1in.am/3253116.html (կարդացեք):

Հետաքրքիր է նաև 2019-2020 թվականների ավտոմեքենաների ներմուծման հանկարծակի անկումը։ Այս անկումը հիմնականում անդրադարձել է ճապոնական մեքենաների ներմուծման կրճատման վրա: Սա պատճառը կարող է լինել կորոնավիրուսոի տարածումը կամ աջաղեկյան մեքենաների ներմուծման արգելքով: Կուզենայի քոմենտներում մեկնաբանություններ լսել սրա մասին:

Հավելված` Ավտոմոբիլների տարեկան առևտուրը Հայաստանում (միավոր, ԱՏԳ ԱԱ դասակարգչ 8703)

| տարի| ներմուծում |#արտահանում |
|----:|------:|------:|
| 2017|    191|   3343|
| 2018|    425|  10639|
| 2019|    771|  33132|
| 2020|    123|   6193|
| 2021|    319|   7362|
| 2022|  10936|  42293|







**Գծապատկեր 1.** 

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
plot_armenia_imports_2017
```


2023 թվականի առաջին 10 ամիսների ընթացքում Հայաստանից արտահանվել է 18 835 ավտոմեքենա (ներմուծվել՝ 70 859), ամբողջ 2022 թվականին արտահանվել է 10 936 ավտոմեքենա (ներմուծվել՝ 42 293)։ 
2023 թվականին արտահանման ծավալներով ամենախոշոր 35֊րդ արտահանողն ենք լինելու, իսկ Վրաստանը մոտ 25-րդ տեղում։ Վրաստանը 2023-ին արտահանելու է մոտ 100 հազար ավտոմեքենա։

Հասկանալի է, որ այս ամենը վերաարտահանում է, ու որ Հայաստանից ավտոմեքենաների արտահանումն աճել է 2022 թվականից Ռուսաստանի դեմ կիրառվող պատժամիջոցներից հետո։ Որպես ԵԱՏՄ անդամ այստեղ շահել ենք, քանի որ այլ իրավիճակում իմաստ չէր լինի ավտոմեքենաները Հյուսիսային Ամերիկայից բերել Վրաստան, ապա Հայաստան, որից հետո տանելլ Ռուսաստան։ ԵԱՏՄ ազատ առևտրի տարածքը որոշակի օգուտներ է տվել նաև այդ մասով։

Թվում է` ամեն ինչ լավ է. ավտոմեքենաների արտահանումն աճել է 2023-ին համեմատած 22 թվականի հետ։ Սակայն իրականությունը, ինչպես գծապատկերն է ցույց տալիս, այդքան էլ դրական չէ։
Վրաստանը այս տարածաշրջանի ավտոմեքենաների հիմնական շուկան է ու այդքան հեշտ չի զիջի իր փայի թեկուզ փոքր մասը Հայաստանին։ Այդ պատճառով է, որ օգոստոսի 1-ից Թբիլիսիի իշխանություններն արգելել են 1,9 լիտր և ավելի շարժիչով ամերիկյան ավտոմեքենաների, ինչպես նաև հիբրիդային և էլեկտրական մեքենաների արտահանումը։ Սա երևում է գծապատկերում։

Եթե նայենք խոշոր հարկատուների ցանկը, 2022 թվականին 2021-ի համեմատ Հայաստանի ավտոներմուծողների շահութահարկը 7-ից 15 անգամ կրկնապատկվել է։ Մեծ շահույթներ են ստացել։ Այդ շահույթը գնացել է հետագա վերաարտահանման հույսով նոր ավտոմեքենաներ ձեռքբերելուն ։

Մեր շուկա բավականին մեծ քանակությամբ մեքենա է մտել, ինչը լցրել է մաքսակետերը ու ներմուծողների ավտոկայանատեղիները։ Իսկ ավտոմեքենան այնպիսի ապրանք է, որ ժամանակի ընթացքում արժեզրկվում է։

Կարելի է սպասել, որ 2024 թվականին ավտոներմուծողները ստիպված են լինելու վնասով մեծ քանակությամբ ավտոմեքենաներ վաճառել ներքին շուկայում, այսինքն կարող է մեքենաների գները հաջորդ տարի լավ իջնեն, մեքենաների քանակը շատանա, բայց նաև փողոցներում ավտոմեքենաներն ավելի թարմ թվի լինեն։

**Գծապատկեր 2.** 

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}

```

Փաստորեն Վրաստանն էլ 2023 թվականի օգոստոսից չի արտահանում դեպի Ռուսատան մեքենաներ


**Գծապատկեր 3.** 

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
auto_trade_armenia_plot
```



**Գծապատկեր 4.** 

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
auto_trade_georgia_plot
```




## 2. ԶԼՄ հաղորդագրություններ

Այս շաբաթ հարցազրույց եմ տվյալ 1in.am լրատվամիջոցին, որտեղ ամփոփել եմ այս և [անցած շաբաթվա հետազոտությունները](https://www.tvyal.com/newsletter/2024/2024_01_07)

Հարցազրույցի անվանումն է՝ [Երևանում հարուստները ավելի են հարստացել, աղքատները՝ ավելի աղքատացել, մարզերում հիմնականում աղքատացել են](https://youtu.be/D0CsyhYC9Zo)

<a href="https://youtu.be/D0CsyhYC9Zo">
  <img src="https://i3.ytimg.com/vi/D0CsyhYC9Zo/maxresdefault.jpg" alt="YouTube Video" style="width:60%;">
</a>

Առկա է նաև այս հարցազրույցի [youtube short-ը](https://www.youtube.com/shorts/11oDLyh4ukw)։

<a href="https://www.youtube.com/shorts/11oDLyh4ukw">
  <img src="media/1in_am_short.png" alt="YouTube Short" style="width:20%;">
</a>



## 3. English Summary

**Yerevan is More Expensive than Moscow in 2023**



---

Այս վերլուծությունը առկա է նաև [մեր կայքէջում](https://www.tvyal.com/newsletter/2024/2024_01_12), այս վերլուծության կոդը և տվյալները դրված են նաև [Github-ում](https://github.com/tavad/tvyal_newsletter)։                        
---                  

Եթե հնարավոր է, խնդրում եմ այս նյութը ուղարկել նաև այն մարդկանց, ում այն կարծում եք կարող է հետաքրքրել:

Սպասեք հաջորդ հաղորդագրությանը հաջորդ ուրբաթ օրը:      


Հարգանքներով,            
Աղասի Թավադյան         
12.01.2024          
[tvyal.com](https://www.tvyal.com/)      
[tavadyan.com](https://www.tavadyan.com/)

---

[Was this email forwarded to you? Subscribe here.](https://www.tvyal.com/subscribe)

[Բաժանորդագրվեք](https://www.tvyal.com/subscribe)

       
---              
               


####### **Ուշադրություն. Ձեր էլ.փոստը մեյլիսթի մեջ է, որի միջոցով ես կիսվում եմ շաբաթական նյութեր, որոնք հիմնականում ներկայացնում են Հայաստանի տնտեսությանը: Նյութերը ներառում են գծապատկերներ, [տվյալների բազաներ](https://github.com/tavad/tvyal_newsletter), տեսանյութեր, հոդվածներ, [առցանց վահանակներ](https://www.tvyal.com/projects), տնտեսական գործիքներ, կանխատեսումներ և հաշվետվություններ: Եթե ցանկանում եք չեղարկել բաժանորդագրությունը, խնդրում եմ տեղեկացրեք ինձ, և ես կհեռացնեմ ձեր էլ. փոստը ցուցակից: Գրեք նաև եթե ունեք մենկնաբանություններ:**

####### **Important! Your email is part of the mailing list where I share weekly materials primarily focused on the Armenian economy. These materials encompass charts, [databases](https://github.com/tavad/tvyal_newsletter), videos, articles, [online dashboards](https://www.tvyal.com/projects), economic tools, forecasts, and reports. If you wish to unsubscribe, please let me know, and I will remove your email from the list. Please share your comments as well․**







