vots_pct = total_votes/ total_participants,
correl = cor(pct_participants, votes_pct)
)
total_participants
total_participants
results_clean
total_votes <-
results_clean %>%
summarise(total_votes = sum(party_votes)) %>%
pull(total_votes)
total_votes
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants
) %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ total_votes,
correl = cor(pct_participants, votes_pct)
)
all_votes <-
results_clean %>%
summarise(total_votes = sum(party_votes)) %>%
pull(total_votes)
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants
) %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
correl = cor(pct_participants, votes_pct)
)
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants
) %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
correl = cor(pct_participants, votes_pct)
) %>%
arrange(desc(total_votes))
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
# grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
#       tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants
) %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
correl = cor(pct_participants, votes_pct)
) %>%
arrange(desc(total_votes))
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants
) %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
correl = cor(pct_participants, votes_pct)
) %>%
arrange(desc(total_votes))
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants
) %>%
group_by(party) %>%
summarise(
correl = cor.test(pct_participants, votes_pct)
)
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants
) %>%
# group_by(party) %>%
summarise(
correl = cor.test(pct_participants, votes_pct)
)
results_clean %>%
ggplot(aes(votes_pct, pct_participants, color = ifelse(errors != 0, TRUE, FALSE))) +
geom_point(alpha = 0.4) +
facet_wrap(~party, scales = "free_x") +
labs(
x = "Քվեարկողների մեջ տվյալ կուսակցությանը ձայնը տվածների տոկոսը",
y = "Քվեարկության մասնակիցների տոկոսը"
) +
ggthemes::theme_clean() +
theme(legend.position = "bottom")
results_filtered %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
correl = cor(pct_participants, votes_pct)
) %>%
arrange(desc(total_votes))
results_filtered <-
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants
)
results_filtered %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
correl = cor(pct_participants, votes_pct)
) %>%
arrange(desc(total_votes))
results_filtered %>%
ggplot(aes(votes_pct, pct_participants, color = ifelse(errors != 0, TRUE, FALSE))) +
geom_point(alpha = 0.4) +
facet_wrap(~party, scales = "free_x") +
labs(
x = "Քվեարկողների մեջ տվյալ կուսակցությանը ձայնը տվածների տոկոսը",
y = "Քվեարկության մասնակիցների տոկոսը"
) +
ggthemes::theme_clean() +
theme(legend.position = "bottom")
results_filtered %>% view()
results_filtered %>% ggplot(aes(n_participants)) + geom_density()
results_filtered %>%
ggplot(aes(votes_pct, pct_participants, color = n_participants)) +
geom_point(alpha = 0.4) +
facet_wrap(~party, scales = "free_x") +
labs(
x = "Քվեարկողների մեջ տվյալ կուսակցությանը ձայնը տվածների տոկոսը",
y = "Քվեարկության մասնակիցների տոկոսը"
) +
ggthemes::theme_clean() +
theme(legend.position = "bottom")
results_filtered %>%
ggplot(aes(votes_pct, pct_participants)) +
geom_point(alpha = 0.4) +
facet_wrap(~party, scales = "free_x") +
labs(
x = "Քվեարկողների մեջ տվյալ կուսակցությանը ձայնը տվածների տոկոսը",
y = "Քվեարկության մասնակիցների տոկոսը"
) +
ggthemes::theme_clean() +
theme(legend.position = "bottom")
results_filtered %>%
ggplot(aes(votes_pct, pct_participants)) +
geom_point(alpha = 0.4) +
facet_wrap(~party, scales = "free_x") +
scale_x_continuous(labels = percent_format())
results_filtered %>%
ggplot(aes(votes_pct, pct_participants)) +
geom_point(alpha = 0.4) +
facet_wrap(~party, scales = "free_x") +
scale_x_continuous(labels = percent_format()) +
scale_y_continuous(labels = percent_format()) +
labs(
x = "Քվեարկողների մեջ տվյալ կուսակցությանը ձայնը տվածների տոկոսը",
y = "Քվեարկության մասնակիցների տոկոսը"
) +
ggthemes::theme_clean() +
theme(legend.position = "bottom")
results_clean
results_clean <-
results %>%
rename(
setNames(names(.)[1:15], election_names),
errors = names(.)[30]
) %>%
filter(hamaynq != 1, hamaynq != "Ընդամենը") %>%
pivot_longer(
-c(election_names, errors),
names_to = "party", values_to = "party_votes"
) %>%
select(-district) %>%
left_join(commitions_filtred, by = join_by(district_n))
results_clean
results_clean %>% pull(party)
results_clean %>% pull(party) %>% unique()
results_clean <-
results %>%
rename(
setNames(names(.)[1:15], election_names),
errors = names(.)[30]
) %>%
filter(hamaynq != 1, hamaynq != "Ընդամենը") %>%
pivot_longer(
-c(election_names, errors),
names_to = "party", values_to = "party_votes"
) %>%
select(-district) %>%
left_join(commitions_filtred, by = join_by(district_n)) %>%
mutate(party_number = 1:14)
results_clean
results_clean <-
results %>%
rename(
setNames(names(.)[1:15], election_names),
errors = names(.)[30]
) %>%
filter(hamaynq != 1, hamaynq != "Ընդամենը") %>%
pivot_longer(
-c(election_names, errors),
names_to = "party", values_to = "party_votes"
) %>%
select(-district) %>%
left_join(commitions_filtred, by = join_by(district_n)) %>%
group_by(district_n) %>%
mutate(party_number = 1:14)
results_clean <-
results %>%
rename(
setNames(names(.)[1:15], election_names),
errors = names(.)[30]
) %>%
filter(hamaynq != 1, hamaynq != "Ընդամենը") %>%
pivot_longer(
-c(election_names, errors),
names_to = "party", values_to = "party_votes"
) %>%
select(-district) %>%
left_join(commitions_filtred, by = join_by(district_n)) %>%
group_by(district_n) %>%
mutate(party_number = 1:14) %>%
ungroup()
results_clean
all_votes <-
results_clean %>%
summarise(total_votes = sum(party_votes)) %>%
pull(total_votes)
results_filtered <-
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants
)
results_filtered %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
correl = cor(pct_participants, votes_pct)
) %>%
arrange(desc(total_votes))
results_filtered %>%
mutate(party = paste0(party_number, ". " party))
results_filtered
results_filtered %>% view()
results_filtered %>%
mutate(party = paste0(party_number, ". ", party))
results_filtered %>%
mutate(party = paste0(party_number, ". ", party)) %>%
ggplot(aes(votes_pct, pct_participants)) +
geom_point(alpha = 0.4) +
facet_wrap(~party, scales = "free_x") +
scale_x_continuous(labels = percent_format()) +
scale_y_continuous(labels = percent_format()) +
labs(
x = "Քվեարկողների մեջ տվյալ կուսակցությանը ձայնը տվածների տոկոսը",
y = "Քվեարկության մասնակիցների տոկոսը"
) +
ggthemes::theme_clean() +
theme(legend.position = "bottom")
results_filtered %>%
mutate(
party = paste0(party_number, ". ", party),
party = fct_inorder(party)
) %>%
ggplot(aes(votes_pct, pct_participants)) +
geom_point(alpha = 0.4) +
facet_wrap(~party, scales = "free_x") +
scale_x_continuous(labels = percent_format()) +
scale_y_continuous(labels = percent_format()) +
labs(
x = "Քվեարկողների մեջ տվյալ կուսակցությանը ձայնը տվածների տոկոսը",
y = "Քվեարկության մասնակիցների տոկոսը"
) +
ggthemes::theme_clean() +
theme(legend.position = "bottom")
results_filtered <-
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants
)
results_filtered <-
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants,
party = paste0(party_number, ". ", party),
party = fct_inorder(party)
)
results_filtered %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
correl = cor(pct_participants, votes_pct)
)
results_plot <-
results_filtered %>%
ggplot(aes(votes_pct, pct_participants)) +
geom_point(alpha = 0.4) +
facet_wrap(~party, scales = "free_x") +
scale_x_continuous(labels = percent_format()) +
scale_y_continuous(labels = percent_format()) +
labs(
x = "Քվեարկողների մեջ տվյալ կուսակցությանը ձայնը տվածների տոկոսը",
y = "Քվեարկության մասնակիցների տոկոսը"
) +
ggthemes::theme_clean() +
theme(legend.position = "bottom")
# the code below downloads the databases, run this only if the files are not present
download_links(commissions_link, downlaod_name = "commissions")
# Տեղամասային ընտրական հանձնաժողովների կազմերը
# Compositions of precinct election commissions
commissions_link <- "https://www.elections.am/File/PecMembersToExcel?electionId=27816"
# the code below downloads the databases, run this only if the files are not present
download_links(commissions_link, downlaod_name = "commissions")
# Տեղամասային ընտրական հանձնաժողովների կազմերը
# Compositions of precinct election commissions
commissions_link <- "https://www.elections.am/File/PecMembersToExcel?electionId=27816"
# the code below downloads the databases, run this only if the databases are not present
download_links(commissions_link, downlaod_name = "commissions")
commitions <- read_excel("commissions.xlsx")
commitions
commissions_filtred <-
commissions %>%
set_names(c("marz", "hamaynq", "district", "district_n", "andam", "vkayakan",
"role", "position")) %>%
filter(position == "նախագահ") %>%
select(district, district_n, role) %>%
mutate(role = str_remove_all(role, "[\n|\r]"))
commissions <- read_excel("commissions.xlsx")
commissions_filtred <-
commissions %>%
set_names(c("marz", "hamaynq", "district", "district_n", "andam", "vkayakan",
"role", "position")) %>%
filter(position == "նախագահ") %>%
select(district, district_n, role) %>%
mutate(role = str_remove_all(role, "[\n|\r]"))
results_filtered
results_filtered %>% count(party)
results_plot
results_filtered %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
correl = cor(pct_participants, votes_pct)
)
results_filtered %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
vots_pct = percent(vots_pct, accuracy = 0.01),
total_votes = number(total_votes, accuracy = 1),
correl = cor(pct_participants, votes_pct)
)
results_filtered %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
vots_pct = percent(vots_pct, accuracy = 0.01),
total_votes = number(total_votes, accuracy = 1, decimal.mark = ","),
correl = cor(pct_participants, votes_pct)
)
results_filtered %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
vots_pct = percent(vots_pct, accuracy = 0.01),
total_votes = number(total_votes, accuracy = 1),
correl = cor(pct_participants, votes_pct)
)
results_table <-
results_filtered %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
vots_pct = percent(vots_pct, accuracy = 0.01),
total_votes = number(total_votes, accuracy = 1),
correl = cor(pct_participants, votes_pct)
)
results_table
results_table %>%
knitr::kable()
results_table %>%
set_names("Թեկնածու", "ձայն", "տոկոս", "մասնակիցների թվի և ձայների քանակի կորելացիա") %>%
knitr::kable()
results_filtered <-
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants,
party = paste0(party_number, ". ", party),
party = fct_inorder(party),
pct_participants  = number(pct_participants, accuracy = 0.001)
)
results_filtered
results_filtered <-
results_clean %>%
filter(
# grepl("քաղաքացիական պա", tolower(party)),
grepl("հանրային ձայն|քաղաքացիական պայմանագիր|ազգային առաջընթաց|հանրապետություն|մայր հայաստան",
tolower(party)),
) %>%
mutate(
pct_participants = n_participants / n_total,
votes_pct = party_votes / n_participants,
party = paste0(party_number, ". ", party),
party = fct_inorder(party)
)
results_table <-
results_filtered %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
vots_pct = percent(vots_pct, accuracy = 0.01),
total_votes = number(total_votes, accuracy = 1),
correl = cor(pct_participants, votes_pct),
pct_participants  = number(pct_participants, accuracy = 0.001)
)
results_table <-
results_filtered %>%
group_by(party) %>%
summarise(
total_votes = sum(party_votes),
vots_pct = total_votes/ all_votes,
vots_pct = percent(vots_pct, accuracy = 0.01),
total_votes = number(total_votes, accuracy = 1),
correl = cor(pct_participants, votes_pct),
correl  = number(correl, accuracy = 0.001)
)
results_table
results_table
