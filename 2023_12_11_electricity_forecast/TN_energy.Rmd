---
title: "Tvyal Newsletter"
author: "Aghasi Tavadyan"
date: "2023-12-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(scales)
library(RcppRoll)
library(rvest)
library(countrycode)

rm(list = ls()); gc()

theme_tvyal <- function(base_size = 12, base_family = "sans") 
{
  colors <- deframe(ggthemes::ggthemes_data[["fivethirtyeight"]])
  (ggthemes::theme_foundation(
    base_size = base_size, base_family = base_family) + 
      theme(
        line = element_line(colour = "black"), 
        rect = element_rect(fill = colors["Light Gray"], linetype = 0, colour = NA), 
        text = element_text(colour = colors["Dark Gray"]), 
        # axis.title = element_blank(),
        # axis.text = element_text(), 
        axis.ticks = element_blank(),
        axis.line = element_blank(), 
        legend.background = element_rect(), 
        legend.position = "bottom", 
        legend.direction = "horizontal", 
        legend.box = "vertical", 
        panel.grid = element_line(colour = NULL), 
        panel.grid.major = element_line(colour = colors["Medium Gray"]), 
        panel.grid.minor = element_blank(), 
        plot.title = element_text(hjust = 0, size = rel(1.5), face = "bold"),
        plot.margin = unit(c(1, 1, 1, 1), "lines"), strip.background = element_rect()
      )
  )
}

theme_set(theme_tvyal())

save_last_plot <- 
  function(filename, extension = "png", width = 1920, height = 1080) {
    
    filename <- str_replace_all(filename, " ", "_")
    last_plot <- recordPlot()
    
    if (extension == "png") {
      png(paste0(filename, ".", extension), width = width, height = height)
    } else if (extension == "pdf") {
      pdf(paste0(filename, ".", extension), width = width, height = height)
    } else {
      stop("Unsupported file extension. Use 'png' or 'pdf'.")
    }
    
    replayPlot(last_plot)
    dev.off()
    paste0(filename, ".", extension)
  }

main_palette_colors <- RColorBrewer::brewer.pal(12, name = "Paired")
update_geom_defaults("rect", list(fill  = main_palette_colors[2], alpha = 0.8)) 
update_geom_defaults("line", list(color = main_palette_colors[2], alpha = 0.8))
update_geom_defaults("area", list(fill  = main_palette_colors[2], alpha = 0.8))

caption_arm <-  "Հեղինակ` Աղասի Թավադյան   |   tvyal.com   |   tavadyan.com"
caption_eng <-  "Author: Aghasi Tavadyan   |   tvyal.com   |   tavadyan.com"

doParallel::registerDoParallel(cores = 8)

setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
```

```{r reading data, include=FALSE}
expand_type <- 
  function(tbl) {
    tbl <- tbl |> 
      mutate(
        type = case_when(
          type == "ՋԷԿ" ~ "Ջերմաէլեկտրակենտրոն (ՋԷԿ)",
          type == "ՀԱԷԿ" ~ "Հայկական ատոմային էլեկտրակայան (ՀԱԷԿ)",
          type == "ՀԷԿ" ~ "Հիդրոէլեկտրակայան (ՀԷԿ)",
          TRUE ~ type
        )
      )
    return(tbl)
  }

electricity_data <- read_csv("electricity_production_arm.csv") |> expand_type()
electricity_forecast <- read_csv("electricity_forecast.csv") |> expand_type()
```


```{r energy forecast plots, include=FALSE, warning=FALSE}

electricity_forecast_plot1 <- 
  electricity_forecast |> 
  mutate(
    month = month(date),
    year = year(date),
    model_name = str_remove(model_name, "Forecast ")
  ) |> 
  filter(
    !grepl("ընդամենը|Հողմային", type),
    !model_name %in% c("ets", "stlm"),
    grepl("year", period),
    month == 12
  ) |> 
  mutate(
    year = ifelse(
      model_name == "Actual Data",
      year, 
      paste0(year, "\n", model_name)
    ),
    type = fct_reorder(type, value),
    type = fct_rev(type),
  ) |> 
  arrange(year) |> 
  group_by(year) |>
  mutate(
    pct = value / sum(value),
    pct_text = number(pct * 100, accuracy = 1)
  ) |> 
  ungroup() |> 
  ggplot(aes(as.character(year), value, fill = type)) +
  geom_col(position = "dodge") +
  geom_errorbar(
    aes(ymin = ribbon_low , ymax = ribbon_high), position = "dodge"
  ) +
  geom_text(
    aes(y = 100, label = pct_text), 
    position = position_dodge(width = .9)
  ) +
  scale_y_continuous(labels = number_format()) +
  scale_fill_manual(values = main_palette_colors[c(1,2,5,4)]) +
  labs(
    x = NULL,
    y = NULL,
    fill = NULL,
    title = "2023 ընթացքում արևային էլեկտրակայանները արտադրել են ընդհանուրի 12 տոկոսը",
    subtitle = "Էլեկտրաէներգիայի արտադրության ծավալները և կանխատեսում\nմլն. կՎտ. ժամ, գծապատկերի ներքևում տրված են տոկոսային կշիռները",
    caption = paste0(caption_arm, "    |    Կանխատեսումը կատարված է հեղինակի կողմից, տվյալների աղբյուր` pcrc.am")
  )


electricity_forecast_plot2 <- 
  electricity_forecast %>% 
  filter(
    !grepl("auto.arima|stlm", model_name),
    grepl("Monthly", period),
    !grepl("ընդամենը|Հողմային", type),
  ) |> 
  mutate(
    type = fct_reorder(type, value),
    type = fct_rev(type)
  ) |> 
  ggplot(aes(date, value, color = model_name, lty = model_name)) +
  facet_wrap(~type, scales = "free_y") +
  geom_smooth(color = "gray") +
  geom_line(linewidth = 1) +
  geom_ribbon(aes(ymin = ribbon_low , ymax = ribbon_high), alpha = .2) +
  scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
  # scale_y_continuous(labels = dollar_format()) +
  scale_color_manual(values = main_palette_colors[c(2,4,1,5)]) +
  scale_linetype_manual(values = c(1, 2, 2, 2, 2)) +
  labs(
    x = NULL,
    y = NULL,
    fill = NULL,
    title = "2023 ընթացքում արևային էլեկտրակայանները արտադրել են ընդհանուրի 12 տոկոսը",
    subtitle = "Էլեկտրաէներգիայի արտադրության ծավալները և կանխատեսում\nմլն. կՎտ. ժամ, գծապատկերի ներքևում տրված են տոկոսային կշիռները",
    caption = paste0(caption_arm, "    |    Կանխատեսումը կատարված է հեղինակի կողմից, տվյալների աղբյուր` pcrc.am")
  )

electricity_data |> 
  filter(!type %in% c("Ջերմային էներգիա, հազ. ԳՋ", "Այլ աղբյուրներ")) |> 
  ggplot(aes(date, month_value)) +
  geom_line() +
  facet_wrap(~type, scales = "free_y") +
  scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
  ggthemes::theme_fivethirtyeight() +
  labs(
    title = "Ամսական արտադրություն"
  )

```




```{r, include=FALSE}

electricity_plot_1 <- 
  electricity_data |> 
  mutate(year = year(date)) |> 
  filter(
    year >= 2023,
    !grepl("ընդամենը|Այլ|ԳՋ|Հողմային", type),
  ) |> 
  arrange(date) |> 
  group_by(date) |> 
  mutate(
    pct_month = month_value/sum(month_value),
    text = ifelse(pct_month <= 0.01, NA, pct_month),
    text = percent(text, accuracy = 0.1)
  ) |> 
  ggplot(aes(date, month_value, fill = type, label = text)) +
  geom_col(alpha = 0.7) +
  geom_text(position = position_stack(vjust = 0.5)) +
  scale_x_date(date_breaks = "1 months", date_labels = "%m-%Y") +
  # scale_y_continuous(breaks = seq(0, 1, 0.1), labels = percent_format()) +
  scale_fill_brewer(type = "qual", palette = 3) +
  ggthemes::theme_fivethirtyeight() +
  labs(
    fill = NULL,
    title = "Արևայինը ապահովել է ընդհանուր էլ. արտադրության 30.1%-ը (2023թ. հուլիսին)",
    subtitle = "Հայաստանի էլեկտրաէներգիայի արտադրության ծավալները\nԱմսական կտրվածքով, մլն. կՎտ. ժամ",
    caption = "Հեղինակ` Աղասի Թավադյան   |   tvyal.com   |   tavadyan.com    |    Տվյալների աղբյուր` psrc.am"
  )
  

electricity_data |> 
  filter(
    !grepl("ընդամենը|Այլ|ԳՋ|Հողմային", type),
    !is.na(YoY_value)
    ) |> 
  arrange(date) |> 
  group_by(date) |> 
  mutate(
    pct_YoY = YoY_value/sum(YoY_value),
    year = year(date)
  ) |> 
  group_by(year) |> 
  mutate(
    text = ifelse(date == max(date) | date == as.Date("2016-02-01"), pct_YoY, NA),
    text = ifelse(text <= 0.01, NA, text),
    text = percent(text, accuracy = 0.1)
  ) |> 
  ungroup() |> 
  ggplot(aes(date, pct_YoY, fill = type, label = text)) +
  geom_area(alpha = 0.6) +
  geom_text(position = position_stack(vjust = 0.5)) +
  scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
  scale_y_continuous(breaks = seq(0, 1, 0.1), labels = percent_format()) +
  scale_fill_brewer(type = "qual", palette = 3) +
  ggthemes::theme_fivethirtyeight()
```



```{r include=FALSE}
natural_gas <-  read_csv("natural_gas_trade_armenia.csv")

# natural_gas |> 
#   filter(
#     mot_code != 9110,
#     !trade_code %in% c("FM", "X")
#   ) |> 
#   select(-c(
#     period_desc, aggregate_level, is_leaf_code, partner_code,
#     reporter_code, mot_code, mot_desc, QtyUnitAbbr, QtyUnitCode, Qty,
#     cifvalue, fobvalue, IsAggregate, IsReported
#   )) |> 
#   write_csv("natural_gas_trade_armenia.csv")

natural_price_imports_plot <- 
  natural_gas |> 
  filter(
    trade_code == "M",
    partner_iso != "_X"
  ) |> 
  mutate(
     cubic_meter_price = trade_value_us / netweight_kg / 1.499 * 1000,
  ) |> 
  filter(
    cubic_meter_price != min(cubic_meter_price)
  ) |> 
  ggplot(aes(period, cubic_meter_price, color = partner)) +
  geom_line(linewidth = 1.2) +
  scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
  scale_y_continuous(labels = dollar_format()) +
  scale_color_manual(values = main_palette_colors[c(5,2)]) +
  labs(
    x = NULL,
    y = NULL,
    color = NULL,
    title = "Import Price of Pertol and Diesel Fuils into Armenia",
    subtitle = "Armenian Drams for 1 Liter",
    caption = "The import price is calculated using the formula: (trade value in USD) / (nerweight in kg) / (dencity l/kg) * USD_AMD\nPetrol density = 0.737, Diesel density = 0.885\n\nAuthor: Aghasi Tavadyan    |    tvyal.com    |    tavadyan.com    |    Data source: Comtrade"
  )
  

# Այս պահին կապույտ վառելիքի գինը սահմանին 1000 խմ դիմաց 165 դոլար է: 
# https://planetcalc.com/9975/       CH4


# fuel_price_plot_3
natural_gas |>
  filter(
    trade_code == "M",
    partner_iso == "RUS"
  ) |> 
  ggplot(aes(period, netweight_kg / 1e6, color = partner)) +
  geom_smooth(color = "gray") +
  geom_line(linewidth = 1.2) +
  scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
  scale_y_continuous(labels = number_format(accuracy = 1))
  # facet_wrap(~partner, scales = "free_y")
  # labs(
  #   x = NULL,
  #   y = NULL,
  #   title = "The annual imports of Natural Gas to Armenia",
  #   subtitle = "Million litters",
  #   caption =  zpaste0(caption_eng, "   |    Data source: Comtrade")
  # )



# save_last_plot("The annual imports of Petrolium fuel to Armenia.png")


```





***English summary below.***

Հարգելի գործընկեր,

Հուսով եմ լավ եք:
Ներկայացնում եմ անցած շաբաթվա վերլուծությունները և աշխատանքները.

1. Բենզինի գնի թանկացման պատճառները
2. ԶԼՄ հաղորդագրություններ
3. Սպասում եմ ձեզ իմ սթրիմին
4. English summary


## 1. Բենզինի գնի թանկացման պատճառները

Այս շաբաթվա հետազոտությունը անելու համար օգտվել ենք հետևյալ աղբյուրներից․

* Բենզինի և դիզելային վառելիքի գնի օրական տվյալների, ձևավորված [1in.am Յութուբյան ալիքի տեսանյութերի նկարներից](https://img.youtube.com/vi/tV15O3Ilrc8/maxresdefault.jpg)
* Վառելիքի թանկացման ամսական տվյալների բազան ըստ [ՍԳԻ սկսած 2017թ․](https://www.armstat.am/am/?nid=82&id=2611)
* վառելիքի ներմուծման ամսական տվյալների բազան ըստ 6-նիշ արտաքին տնտեսական գործունեության ծածկագրերի և պետությունների

Բոլոր տվյալների բազաները և գծապատկերների կոդը առկա է իմ [Github-ում](https://github.com/tavad/tvyal_newsletter)

------------------

Նախ ուսումնասիրենք բենզինի գինը տարածաշրջանի այն երկրներում, որոնք հիմնականում համարվում են նավթամթերք ներմուծող պետություն։ Նշեմ, որ Հայաստանում համեմատած մեր հարևանների և ԵԱՏՄ երկրների բենզինի գինը ամենաբարձրն է։ Սակայն սրա պատճառները հիմնականում տրանսպորտային ծախսերն են և այն հանգամանքը, որ Հայաստանը նավթամթերք արտադրող պետություն չէ։ ՀՀ դրամով հաշվարկված այս պահին, Վրաստանում բենզինի գինը կազմում է մոտ 500 դրամ։
     
**Գծապատկեր 1.** Բենզինի միջին գնիը Հայաստանում և տարածաշրջանի բանզին ներմուծող այլ պետություններում

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
electricity_forecast_plot1
```

Գծապատկեր 2-ում ներկայացված է բենզինի ընդհանուր քանակության ներմուծումը միլիոն կիլոգրամով: Ինչպես երևում է գծապատկերից նավթամթերքի ներմուծման ծավալները 2010-ից 2019թ. սկիզբը եղել են գրեթե անփոփոխ: 2019 թվականից սկսած գրանցվել է նավթամթերիքի ներմուծման շարունակական և կայուն աճ: 2017թ. ներմուծվել է համապատասխանաբար 200 և 140 մլն կիլոգրամ դիզվառելիք և բենզին, իսկ 2022թ արդեն 300 և 225 հազար կիլոգրամ: Ընդհանուր նավթամթերի ներկրումը վերջին 5 տարիների ընթացքում աճել է 1.5 անգամ։ Նավթամթերքը էներգիայի կարևոր աղբյուր է, որն ապահովում է տրանսպորտային և արդյունաբերական գործունեությունը: Երբ երկիրն ավելի շատ բենզին է ներկրում, դա ընդհանուր առմամբ նշանակում է, որ էներգիայի ներքին պահանջարկը մեծանում է։ Սա կարող է լինել աճող տնտեսության ցուցանիշ, որը վկայում է սպառողական ծախսերի, ձեռնարկատիրական գործունեության և արդյունաբերական արտադրության աճի վերաբերյալ:


**Գծապատկեր 2.** Բենզինի և դիզվառելիքի Հայաստան ներմուծման տարեկան ծավալները

```{r, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 8}
electricity_forecast_plot2
```


Գծապատկեր 3-ում ներկայացված է բենզինի գնի փոփոխությունը, ըստ 1in.am լրատվամիջոցի օրական հրապարակումների: Այս տվյալները ստացվել են քերելով 1in.am Յութուբյան ալիքի բենզինի գների վերաբերյալ տեսանյութերի նկարները (thumbnails): Ինչպես երևում է գծապատկերից բենզինի գինը մինչև 2023 թվականին գրանցված աճը, ամենաբարձրն է եղել 2022 թվականի ապրիլին, երբ 1 լիտր պրեմիում դասի բենզինը արժեր 540 դրամ: 2022թ. վերջին պրեմիում դասի բենզինի գինը նվազեց մինչև 350 դրամ 1 լիտրի համար, որը գրանցվել էր 2023 թվականի փետրվարին: 2023 թվականին շարունակաբար գրանցվեց վառելիքի գնի բարձրացում: Թե ինչո՞վ էր պայմանավորված այդ բարձրացումը կքննարկենք հաջորդիվ: 


**Գծապատկեր 3.** Բենզինի և դիզելային վառելիքի գինը Հայաստանում (ՀՀ դրամ)

```{r, echo=FALSE, fig.width = 12, fig.height = 8}
electricity_plot_1
```

Հաջորդ գծապատկերում տրված է հողուկ գազի լիտրի գինը ներքին շուկայում։

**Գծապատկեր 4.** Հեղուկ գազի Հայաստանում (ՀՀ դրամ)

```{r, echo=FALSE, fig.width = 12, fig.height = 8}
natural_price_imports_plot
```


Ստորև ներկայացված է բենզինի և դիզելային վառելիքի ներմուծման գինը: Այն հաշվարկվել է բաժանելով տվյալ ամսվա ներմուծման արժեքային և բնեղեն տվյալները, որից ստացվել է բենզինի գնի կիլոգրամի ներմուծման արժեքը ԱՄՆ դլորով: Ստացված ցուցանիշը բաժանվել է բենզինի և դիզելի խտության վրա և բազմապատկվել տվյալ ամսվա միջին ԱՄՆ դոլար դրամ փոխարժեքով: Իհարկե ստացված ցուցանիշը ոնի որոշակի ճշգրտության խնդիր, քանի որ նավթամթերքի խտությունը ըստ ջերմաստիճանի կարող է փոխվել ինչպես նաև պետք է հաշվի առնել դոլարի վաճառքի գինը ներքին շուկայում։ Սակայն այս ցուցանիշի դինամիկան հստակ պատկերացում կարող է տալ թե ինչքանով է տարբերվում նավթամթերքի գինը սահմանին, որը ձեռք են բերում մեր տնտեսվարողները և բենզինի գինը ներքին շուկայում։


## 2. ԶԼՄ հաղորդագրություններ

[1in.am լրատվամիջոցին](https://youtu.be/RS6Qu_Im4Dw?t=6) տվել եմ հարցազրույց 

* Ինչպե՞ս կառավարությունը դարձավ ԶՊՄԿ 23 տոկոսի բաժնետեր:
* Ի՞նչ ապրանք ենք արտահանել, որը սանկցիաների տակ է ընկել:
* Ինչպե՞ս Mobile Center խանութների ցանցը դարձավ 6-րդ ամենախոշոր հարկատուն; 
* Բացի Ռուսաստանից էլ որտե՞ղ կարող ենք արտահանել մեր ծիրանը:

[![](https://i3.ytimg.com/vi/RS6Qu_Im4Dw/maxresdefault.jpg)](https://youtu.be/RS6Qu_Im4Dw?t=6)


[RUSARM INFO](https://www.youtube.com/watch?v=gMc6O6eAqRA) լրատվամիջոցով ռուսերենով խոսել եմ

[![](https://i3.ytimg.com/vi/gMc6O6eAqRA/maxresdefault.jpg)](https://www.youtube.com/watch?v=gMc6O6eAqRA)



## 3. English Summary

**Exploring Gasoline Prices – What's Behind the Recent Spike?**

This week's newsletter delves into the factors influencing the recent surge in gasoline prices in Armenia. It analyzes various data sources, including daily petrol and diesel price data, monthly fuel price databases, and fuel import statistics. Highlighting Armenia's position as a significant gasoline-importing country, the analysis explores the impact of transportation costs and Armenia's non-oil-producing status on fuel prices. It notes the steady increase in petroleum product imports since 2019 and discusses the correlation between gasoline prices, import volumes, and domestic demand for energy. The newsletter emphasizes the competitive nature of Armenia's domestic oil market and suggests that regulating prices at the border is crucial for effectively managing and lowering gasoline prices in the country. The potential to diversify gasoline imports from Iran as a means of reducing transportation costs is also explored as a possible solution. The comprehensive data visualizations accompanying the analysis provide a detailed overview of the key trends and dynamics driving gasoline prices in Armenia.

    

Այս վերլուծությունը առկա է նաև [մեր կայքէջում](https://www.tvyal.com/newsletter/2023_12_11), այս վերլուծության կոդը և տվյալները դրված են նաև [Github-ում](https://github.com/tavad/tvyal_newsletter)։                        
                  

Եթե հնարավոր է, խնդրում եմ այս նյութը ուղարկել նաև այն մարդկանց, ում այն կարծում եք կարող է հետաքրքրել:

Սպասեք հաջորդ հաղորդագրությանը մի շաբաթվա ընթացքում:        

          
           
           


Հարգանքներով,            
Աղասի Թավադյան         
11.12.2023          
[tvyal.com](https://www.tvyal.com/)      
[tavadyan.com](https://www.tavadyan.com/)

       
              
               


####### **Ուշադրություն. Ձեր էլ.փոստը մեյլիսթի մեջ է, որի միջոցով ես կիսվում եմ շաբաթական նյութեր, որոնք հիմնականում ներկայացնում են Հայաստանի տնտեսությանը: Նյութերը ներառում են գծապատկերներ, [տվյալների բազաներ](https://github.com/tavad/tvyal_newsletter), տեսանյութեր, հոդվածներ, [առցանց վահանակներ](https://www.tvyal.com/projects), տնտեսական գործիքներ, կանխատեսումներ և հաշվետվություններ: Եթե ցանկանում եք չեղարկել բաժանորդագրությունը, խնդրում եմ տեղեկացրեք ինձ, և ես կհեռացնեմ ձեր էլ. փոստը ցուցակից: Գրեք նաև եթե ունեք մենկնաբանություններ:**

####### **Important! Your email is part of the mailing list where I share weekly materials primarily focused on the Armenian economy. These materials encompass charts, [databases](https://github.com/tavad/tvyal_newsletter), videos, articles, [online dashboards](https://www.tvyal.com/projects), economic tools, forecasts, and reports. If you wish to unsubscribe, please let me know, and I will remove your email from the list. Please share your comments as well․**







